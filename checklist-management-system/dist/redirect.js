!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=38)}({10:function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},15:function(t,e,r){"use strict";r.r(e);let i={debug(){},info(){},warn(){},error(){}};const n=0,s=1,o=2,a=3,h=4;let u,c;class l{static get NONE(){return n}static get ERROR(){return s}static get WARN(){return o}static get INFO(){return a}static get DEBUG(){return h}static reset(){c=a,u=i}static get level(){return c}static set level(t){if(!(n<=t&&t<=h))throw new Error("Invalid log level");c=t}static get logger(){return u}static set logger(t){if(!t.debug&&t.info&&(t.debug=t.info),!(t.debug&&t.info&&t.warn&&t.error))throw new Error("Invalid logger");u=t}static debug(...t){c>=h&&u.debug.apply(u,Array.from(t))}static info(...t){c>=a&&u.info.apply(u,Array.from(t))}static warn(...t){c>=o&&u.warn.apply(u,Array.from(t))}static error(...t){c>=s&&u.error.apply(u,Array.from(t))}}l.reset();const d={setInterval:function(t,e){return setInterval(t,e)},clearInterval:function(t){return clearInterval(t)}};let g=!1,p=null;class f{static _testing(){g=!0}static get location(){if(!g)return location}static get localStorage(){if(!g&&"undefined"!=typeof window)return localStorage}static get sessionStorage(){if(!g&&"undefined"!=typeof window)return sessionStorage}static setXMLHttpRequest(t){p=t}static get XMLHttpRequest(){if(!g&&"undefined"!=typeof window)return p||XMLHttpRequest}static get timer(){if(!g)return d}}class v{constructor({prefix:t="oidc.",store:e=f.localStorage}={}){this._store=e,this._prefix=t}set(t,e){return l.debug("WebStorageStateStore.set",t),t=this._prefix+t,this._store.setItem(t,e),Promise.resolve()}get(t){l.debug("WebStorageStateStore.get",t),t=this._prefix+t;let e=this._store.getItem(t);return Promise.resolve(e)}remove(t){l.debug("WebStorageStateStore.remove",t),t=this._prefix+t;let e=this._store.getItem(t);return this._store.removeItem(t),Promise.resolve(e)}getAllKeys(){l.debug("WebStorageStateStore.getAllKeys");var t=[];for(let e=0;e<this._store.length;e++){let r=this._store.key(e);0===r.indexOf(this._prefix)&&t.push(r.substr(this._prefix.length))}return Promise.resolve(t)}}class y{constructor(t=f.XMLHttpRequest){this._XMLHttpRequest=t}getJson(t,e){if(!t)throw l.error("JsonService.getJson: No url passed"),new Error("url");return l.debug("JsonService.getJson, url: ",t),new Promise((r,i)=>{var n=new this._XMLHttpRequest;n.open("GET",t),n.onload=function(){if(l.debug("JsonService.getJson: HTTP response received, status",n.status),200===n.status){var e=n.getResponseHeader("Content-Type");if(e&&e.startsWith("application/json"))try{r(JSON.parse(n.responseText))}catch(t){l.error("JsonService.getJson: Error parsing JSON response",t.message),i(t)}else i(Error("Invalid response Content-Type: "+e+", from URL: "+t))}else i(Error(n.statusText+" ("+n.status+")"))},n.onerror=function(){l.error("JsonService.getJson: network error"),i(Error("Network Error"))},e&&(l.debug("JsonService.getJson: token passed, setting Authorization header"),n.setRequestHeader("Authorization","Bearer "+e)),n.send()})}}const m=".well-known/openid-configuration";class S{constructor(t,e=y){if(!t)throw l.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=t,this._jsonService=new e}get metadataUrl(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(m)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=m))),this._metadataUrl}getMetadata(){return this._settings.metadata?(l.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(l.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then(t=>(l.debug("MetadataService.getMetadata: json received"),this._settings.metadata=t,t))):(l.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))}getIssuer(){return this._getMetadataProperty("issuer")}getAuthorizationEndpoint(){return this._getMetadataProperty("authorization_endpoint")}getUserInfoEndpoint(){return this._getMetadataProperty("userinfo_endpoint")}getTokenEndpoint(){return this._getMetadataProperty("token_endpoint",!0)}getCheckSessionIframe(){return this._getMetadataProperty("check_session_iframe",!0)}getEndSessionEndpoint(){return this._getMetadataProperty("end_session_endpoint",!0)}getRevocationEndpoint(){return this._getMetadataProperty("revocation_endpoint",!0)}_getMetadataProperty(t,e=!1){return l.debug("MetadataService.getMetadataProperty for: "+t),this.getMetadata().then(r=>{if(l.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===r[t]){if(!0===e)return void l.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+t);throw l.error("MetadataService.getMetadataProperty: Metadata does not contain property "+t),new Error("Metadata does not contain property "+t)}return r[t]})}getSigningKeys(){return this._settings.signingKeys?(l.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then(t=>(l.debug("MetadataService.getSigningKeys: jwks_uri received",t),this._jsonService.getJson(t).then(t=>{if(l.debug("MetadataService.getSigningKeys: key set received",t),!t.keys)throw l.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return this._settings.signingKeys=t.keys,this._settings.signingKeys})))}}class F{constructor(t,e=y,r=S){if(!t)throw l.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new e,this._metadataService=new r(this._settings)}getClaims(t){return t?this._metadataService.getUserInfoEndpoint().then(e=>(l.debug("UserInfoService.getClaims: received userinfo url",e),this._jsonService.getJson(e,t).then(t=>(l.debug("UserInfoService.getClaims: claims received",t),t)))):(l.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))}}class w extends Error{constructor({error:t,error_description:e,error_uri:r,state:i}={}){if(!t)throw l.error("No error passed to ErrorResponse"),new Error("error");super(e||t),this.name="ErrorResponse",this.error=t,this.error_description=e,this.error_uri=r,this.state=i}}var b=r(4);const E=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];class _{static parseJwt(t){l.debug("JoseUtil.parseJwt");try{var e=b.jws.JWS.parse(t);return{header:e.headerObj,payload:e.payloadObj}}catch(t){l.error(t)}}static validateJwt(t,e,r,i,n,s){l.debug("JoseUtil.validateJwt");try{if("RSA"===e.kty)if(e.e&&e.n)e=b.KEYUTIL.getKey(e);else{if(!e.x5c||!e.x5c.length)return l.error("JoseUtil.validateJwt: RSA key missing key material",e),Promise.reject(new Error("RSA key missing key material"));var o=Object(b.b64tohex)(e.x5c[0]);e=b.X509.getPublicKeyFromCertHex(o)}else{if("EC"!==e.kty)return l.error("JoseUtil.validateJwt: Unsupported key type",e&&e.kty),Promise.reject(new Error("Unsupported key type: "+e&&e.kty));if(!(e.crv&&e.x&&e.y))return l.error("JoseUtil.validateJwt: EC key missing key material",e),Promise.reject(new Error("EC key missing key material"));e=b.KEYUTIL.getKey(e)}return _._validateJwt(t,e,r,i,n,s)}catch(t){return l.error(t&&t.message||t),Promise.reject("JWT validation failed")}}static _validateJwt(t,e,r,i,n,s){n||(n=0),s||(s=parseInt(Date.now()/1e3));var o=_.parseJwt(t).payload;if(!o.iss)return l.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(o.iss!==r)return l.error("JoseUtil._validateJwt: Invalid issuer in token",o.iss),Promise.reject(new Error("Invalid issuer in token: "+o.iss));if(!o.aud)return l.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(o.aud===i||Array.isArray(o.aud)&&o.aud.indexOf(i)>=0))return l.error("JoseUtil._validateJwt: Invalid audience in token",o.aud),Promise.reject(new Error("Invalid audience in token: "+o.aud));var a=s+n,h=s-n;if(!o.iat)return l.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(a<o.iat)return l.error("JoseUtil._validateJwt: iat is in the future",o.iat),Promise.reject(new Error("iat is in the future: "+o.iat));if(o.nbf&&a<o.nbf)return l.error("JoseUtil._validateJwt: nbf is in the future",o.nbf),Promise.reject(new Error("nbf is in the future: "+o.nbf));if(!o.exp)return l.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(o.exp<h)return l.error("JoseUtil._validateJwt: exp is in the past",o.exp),Promise.reject(new Error("exp is in the past:"+o.exp));try{if(!b.jws.JWS.verify(t,e,E))return l.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed"))}catch(t){return l.error(t&&t.message||t),Promise.reject(new Error("signature validation failed"))}return Promise.resolve()}static hashString(t,e){try{return b.crypto.Util.hashString(t,e)}catch(t){l.error(t)}}static hexToBase64Url(t){try{return Object(b.hextob64u)(t)}catch(t){l.error(t)}}}const x=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];class A{constructor(t,e=S,r=F,i=_){if(!t)throw l.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=t,this._metadataService=new e(this._settings),this._userInfoService=new r(this._settings),this._joseUtil=i}validateSigninResponse(t,e){return l.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(t,e).then(e=>(l.debug("ResponseValidator.validateSigninResponse: state processed"),this._validateTokens(t,e).then(t=>(l.debug("ResponseValidator.validateSigninResponse: tokens validated"),this._processClaims(t).then(t=>(l.debug("ResponseValidator.validateSigninResponse: claims processed"),t))))))}validateSignoutResponse(t,e){return t.id!==e.state?(l.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(l.debug("ResponseValidator.validateSignoutResponse: state validated"),e.state=t.data,e.error?(l.warn("ResponseValidator.validateSignoutResponse: Response was error",e.error),Promise.reject(new w(e))):Promise.resolve(e))}_processSigninParams(t,e){if(t.id!==e.state)return l.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!t.client_id)return l.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!t.authority)return l.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==t.authority)return l.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=t.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==t.client_id)return l.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=t.client_id;return l.debug("ResponseValidator._processSigninParams: state validated"),e.state=t.data,e.error?(l.warn("ResponseValidator._processSigninParams: Response was error",e.error),Promise.reject(new w(e))):t.nonce&&!e.id_token?(l.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!t.nonce&&e.id_token?(l.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):Promise.resolve(e)}_processClaims(t){if(t.isOpenIdConnect){if(l.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),t.profile=this._filterProtocolClaims(t.profile),this._settings.loadUserInfo&&t.access_token)return l.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(t.access_token).then(e=>(l.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),e.sub!==t.profile.sub?(l.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in access_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in access_token"))):(t.profile=this._mergeClaims(t.profile,e),l.debug("ResponseValidator._processClaims: user info claims received, updated profile:",t.profile),t)));l.debug("ResponseValidator._processClaims: not loading user info")}else l.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(t)}_mergeClaims(t,e){var r=Object.assign({},t);for(let t in e){var i=e[t];Array.isArray(i)||(i=[i]);for(let e=0;e<i.length;e++){let n=i[e];r[t]?Array.isArray(r[t])?r[t].indexOf(n)<0&&r[t].push(n):r[t]!==n&&(r[t]=[r[t],n]):r[t]=n}}return r}_filterProtocolClaims(t){l.debug("ResponseValidator._filterProtocolClaims, incoming claims:",t);var e=Object.assign({},t);return this._settings._filterProtocolClaims?(x.forEach(t=>{delete e[t]}),l.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",e)):l.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),e}_validateTokens(t,e){return e.id_token?e.access_token?(l.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(t,e)):(l.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(t,e)):(l.debug("ResponseValidator._validateTokens: No id_token to validate"),Promise.resolve(e))}_validateIdTokenAndAccessToken(t,e){return this._validateIdToken(t,e).then(t=>this._validateAccessToken(t))}_validateIdToken(t,e){if(!t.nonce)return l.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));let r=this._joseUtil.parseJwt(e.id_token);if(!r||!r.header||!r.payload)return l.error("ResponseValidator._validateIdToken: Failed to parse id_token",r),Promise.reject(new Error("Failed to parse id_token"));if(t.nonce!==r.payload.nonce)return l.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"));var i=r.header.kid;return this._metadataService.getIssuer().then(n=>(l.debug("ResponseValidator._validateIdToken: Received issuer"),this._metadataService.getSigningKeys().then(s=>{if(!s)return l.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));let o;if(l.debug("ResponseValidator._validateIdToken: Received signing keys"),i)o=s.filter(t=>t.kid===i)[0];else{if((s=this._filterByAlg(s,r.header.alg)).length>1)return l.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));o=s[0]}if(!o)return l.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));let a=t.client_id,h=this._settings.clockSkew;return l.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",h),this._joseUtil.validateJwt(e.id_token,o,n,a,h).then(()=>(l.debug("ResponseValidator._validateIdToken: JWT validation successful"),r.payload.sub?(e.profile=r.payload,e):(l.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))))})))}_filterByAlg(t,e){var r=null;if(e.startsWith("RS"))r="RSA";else if(e.startsWith("PS"))r="PS";else{if(!e.startsWith("ES"))return l.debug("ResponseValidator._filterByAlg: alg not supported: ",e),[];r="EC"}return l.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",r),t=t.filter(t=>t.kty===r),l.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",r,t.length),t}_validateAccessToken(t){if(!t.profile)return l.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!t.profile.at_hash)return l.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!t.id_token)return l.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));let e=this._joseUtil.parseJwt(t.id_token);if(!e||!e.header)return l.error("ResponseValidator._validateAccessToken: Failed to parse id_token",e),Promise.reject(new Error("Failed to parse id_token"));var r=e.header.alg;if(!r||5!==r.length)return l.error("ResponseValidator._validateAccessToken: Unsupported alg:",r),Promise.reject(new Error("Unsupported alg: "+r));var i=r.substr(2,3);if(!i)return l.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,i),Promise.reject(new Error("Unsupported alg: "+r));if(256!==(i=parseInt(i))&&384!==i&&512!==i)return l.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,i),Promise.reject(new Error("Unsupported alg: "+r));let n="sha"+i;var s=this._joseUtil.hashString(t.access_token,n);if(!s)return l.error("ResponseValidator._validateAccessToken: access_token hash failed:",n),Promise.reject(new Error("Failed to validate at_hash"));var o=s.substr(0,s.length/2),a=this._joseUtil.hexToBase64Url(o);return a!==t.profile.at_hash?(l.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",a,t.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(l.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(t))}}const P=".well-known/openid-configuration",C="id_token",R="openid",T=900,D=300;class I{constructor({authority:t,metadataUrl:e,metadata:r,signingKeys:i,client_id:n,client_secret:s,response_type:o=C,scope:a=R,redirect_uri:h,post_logout_redirect_uri:u,prompt:c,display:l,max_age:d,ui_locales:g,acr_values:p,resource:f,filterProtocolClaims:y=!0,loadUserInfo:m=!0,staleStateAge:F=T,clockSkew:w=D,stateStore:b=new v,ResponseValidatorCtor:E=A,MetadataServiceCtor:_=S,extraQueryParams:x={}}={}){this._authority=t,this._metadataUrl=e,this._metadata=r,this._signingKeys=i,this._client_id=n,this._client_secret=s,this._response_type=o,this._scope=a,this._redirect_uri=h,this._post_logout_redirect_uri=u,this._prompt=c,this._display=l,this._max_age=d,this._ui_locales=g,this._acr_values=p,this._resource=f,this._filterProtocolClaims=!!y,this._loadUserInfo=!!m,this._staleStateAge=F,this._clockSkew=w,this._stateStore=b,this._validator=new E(this),this._metadataService=new _(this),this._extraQueryParams="object"==typeof x?x:{}}get client_id(){return this._client_id}set client_id(t){if(this._client_id)throw l.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=t}get client_secret(){return this._client_secret}get response_type(){return this._response_type}get scope(){return this._scope}get redirect_uri(){return this._redirect_uri}get post_logout_redirect_uri(){return this._post_logout_redirect_uri}get prompt(){return this._prompt}get display(){return this._display}get max_age(){return this._max_age}get ui_locales(){return this._ui_locales}get acr_values(){return this._acr_values}get resource(){return this._resource}get authority(){return this._authority}set authority(t){if(this._authority)throw l.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=t}get metadataUrl(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(P)<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=P)),this._metadataUrl}get metadata(){return this._metadata}set metadata(t){this._metadata=t}get signingKeys(){return this._signingKeys}set signingKeys(t){this._signingKeys=t}get filterProtocolClaims(){return this._filterProtocolClaims}get loadUserInfo(){return this._loadUserInfo}get staleStateAge(){return this._staleStateAge}get clockSkew(){return this._clockSkew}get stateStore(){return this._stateStore}get validator(){return this._validator}get metadataService(){return this._metadataService}get extraQueryParams(){return this._extraQueryParams}set extraQueryParams(t){this._extraQueryParams="object"==typeof t?t:{}}}class k{static addQueryParam(t,e,r){return t.indexOf("?")<0&&(t+="?"),"?"!==t[t.length-1]&&(t+="&"),t+=encodeURIComponent(e),t+="=",t+=encodeURIComponent(r)}static parseUrlFragment(t,e="#",r=f){"string"!=typeof t&&(t=r.location.href);var i=t.lastIndexOf(e);i>=0&&(t=t.substr(i+1));for(var n,s={},o=/([^&=]+)=([^&]*)/g,a=0;n=o.exec(t);)if(s[decodeURIComponent(n[1])]=decodeURIComponent(n[2]),a++>50)return l.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",t),{error:"Response exceeded expected number of parameters"};for(var h in s)return s;return{}}}
// @preserve Copyright (c) Microsoft Open Technologies, Inc.
function B(){for(var t="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx",e="0123456789abcdef",r=0,i="",n=0;n<t.length;n++)"-"!==t[n]&&"4"!==t[n]&&(r=16*Math.random()|0),"x"===t[n]?i+=e[r]:"y"===t[n]?(r&=3,i+=e[r|=8]):i+=t[n];return i}class N{constructor({id:t,data:e,created:r}={}){this._id=t||B(),this._data=e,this._created="number"==typeof r&&r>0?r:parseInt(Date.now()/1e3)}get id(){return this._id}get data(){return this._data}get created(){return this._created}toStorageString(){return l.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created})}static fromStorageString(t){return l.debug("State.fromStorageString"),new N(JSON.parse(t))}static clearStaleState(t,e){var r=Date.now()/1e3-e;return t.getAllKeys().then(e=>{l.debug("State.clearStaleState: got keys",e);var i=[];for(let s=0;s<e.length;s++){let o=e[s];var n=t.get(o).then(e=>{let i=!1;if(e)try{var n=N.fromStorageString(e);l.debug("State.clearStaleState: got item from key: ",o,n.created),n.created<=r&&(i=!0)}catch(t){l.error("State.clearStaleState: Error parsing state for key",o,t.message),i=!0}else l.debug("State.clearStaleState: no item in storage for key: ",o),i=!0;if(i)return l.debug("State.clearStaleState: removed item for key: ",o),t.remove(o)});i.push(n)}return l.debug("State.clearStaleState: waiting on promise count:",i.length),Promise.all(i)})}}class H extends N{constructor({nonce:t,authority:e,client_id:r}={}){super(arguments[0]),!0===t?this._nonce=B():t&&(this._nonce=t),this._authority=e,this._client_id=r}get nonce(){return this._nonce}get authority(){return this._authority}get client_id(){return this._client_id}toStorageString(){return l.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,nonce:this.nonce,authority:this.authority,client_id:this.client_id})}static fromStorageString(t){l.debug("SigninState.fromStorageString");var e=JSON.parse(t);return new H(e)}}class j{constructor({url:t,client_id:e,redirect_uri:r,response_type:i,scope:n,authority:s,data:o,prompt:a,display:h,max_age:u,ui_locales:c,id_token_hint:d,login_hint:g,acr_values:p,resource:f,request:v,request_uri:y,extraQueryParams:m}){if(!t)throw l.error("SigninRequest.ctor: No url passed"),new Error("url");if(!e)throw l.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!r)throw l.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!i)throw l.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!n)throw l.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!s)throw l.error("SigninRequest.ctor: No authority passed"),new Error("authority");let S=j.isOidc(i);this.state=new H({nonce:S,data:o,client_id:e,authority:s}),t=k.addQueryParam(t,"client_id",e),t=k.addQueryParam(t,"redirect_uri",r),t=k.addQueryParam(t,"response_type",i),t=k.addQueryParam(t,"scope",n),t=k.addQueryParam(t,"state",this.state.id),S&&(t=k.addQueryParam(t,"nonce",this.state.nonce));var F={prompt:a,display:h,max_age:u,ui_locales:c,id_token_hint:d,login_hint:g,acr_values:p,resource:f,request:v,request_uri:y};for(let e in F)F[e]&&(t=k.addQueryParam(t,e,F[e]));for(let e in m)t=k.addQueryParam(t,e,m[e]);this.url=t}static isOidc(t){return!!t.split(/\s+/g).filter(function(t){return"id_token"===t})[0]}static isOAuth(t){return!!t.split(/\s+/g).filter(function(t){return"token"===t})[0]}}const U="openid";class O{constructor(t){var e=k.parseUrlFragment(t,"#");this.error=e.error,this.error_description=e.error_description,this.error_uri=e.error_uri,this.state=e.state,this.id_token=e.id_token,this.session_state=e.session_state,this.access_token=e.access_token,this.token_type=e.token_type,this.scope=e.scope,this.profile=void 0;let r=parseInt(e.expires_in);if("number"==typeof r&&r>0){let t=parseInt(Date.now()/1e3);this.expires_at=t+r}}get expires_in(){if(this.expires_at){let t=parseInt(Date.now()/1e3);return this.expires_at-t}}get expired(){let t=this.expires_in;if(void 0!==t)return t<=0}get scopes(){return(this.scope||"").split(" ")}get isOpenIdConnect(){return this.scopes.indexOf(U)>=0||!!this.id_token}}class M{constructor({url:t,id_token_hint:e,post_logout_redirect_uri:r,data:i}){if(!t)throw l.error("SignoutRequest.ctor: No url passed"),new Error("url");e&&(t=k.addQueryParam(t,"id_token_hint",e)),r&&(t=k.addQueryParam(t,"post_logout_redirect_uri",r),i&&(this.state=new N({data:i}),t=k.addQueryParam(t,"state",this.state.id))),this.url=t}}class V{constructor(t){var e=k.parseUrlFragment(t,"?");this.error=e.error,this.error_description=e.error_description,this.error_uri=e.error_uri,this.state=e.state}}class K{constructor(t={}){this._settings=t instanceof I?t:new I(t)}get _stateStore(){return this.settings.stateStore}get _validator(){return this.settings.validator}get _metadataService(){return this.settings.metadataService}get settings(){return this._settings}get metadataService(){return this._metadataService}createSigninRequest({response_type:t,scope:e,redirect_uri:r,data:i,state:n,prompt:s,display:o,max_age:a,ui_locales:h,id_token_hint:u,login_hint:c,acr_values:d,resource:g,request:p,request_uri:f,extraQueryParams:v}={},y){l.debug("OidcClient.createSigninRequest");let m=this._settings.client_id;t=t||this._settings.response_type,e=e||this._settings.scope,r=r||this._settings.redirect_uri,s=s||this._settings.prompt,o=o||this._settings.display,a=a||this._settings.max_age,h=h||this._settings.ui_locales,d=d||this._settings.acr_values,g=g||this._settings.resource,v=v||this._settings.extraQueryParams;let S=this._settings.authority;return this._metadataService.getAuthorizationEndpoint().then(F=>{l.debug("OidcClient.createSigninRequest: Received authorization endpoint",F);let w=new j({url:F,client_id:m,redirect_uri:r,response_type:t,scope:e,data:i||n,authority:S,prompt:s,display:o,max_age:a,ui_locales:h,id_token_hint:u,login_hint:c,acr_values:d,resource:g,request:p,request_uri:f,extraQueryParams:v});var b=w.state;return(y=y||this._stateStore).set(b.id,b.toStorageString()).then(()=>w)})}processSigninResponse(t,e){l.debug("OidcClient.processSigninResponse");var r=new O(t);return r.state?(e=e||this._stateStore).remove(r.state).then(t=>{if(!t)throw l.error("OidcClient.processSigninResponse: No matching state found in storage"),new Error("No matching state found in storage");let e=H.fromStorageString(t);return l.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),this._validator.validateSigninResponse(e,r)}):(l.error("OidcClient.processSigninResponse: No state in response"),Promise.reject(new Error("No state in response")))}createSignoutRequest({id_token_hint:t,data:e,state:r,post_logout_redirect_uri:i}={},n){return l.debug("OidcClient.createSignoutRequest"),i=i||this._settings.post_logout_redirect_uri,this._metadataService.getEndSessionEndpoint().then(s=>{if(!s)throw l.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");l.debug("OidcClient.createSignoutRequest: Received end session endpoint",s);let o=new M({url:s,id_token_hint:t,post_logout_redirect_uri:i,data:e||r});var a=o.state;return a&&(l.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),(n=n||this._stateStore).set(a.id,a.toStorageString())),o})}processSignoutResponse(t,e){l.debug("OidcClient.processSignoutResponse");var r=new V(t);if(!r.state)return l.debug("OidcClient.processSignoutResponse: No state in response"),r.error?(l.warn("OidcClient.processSignoutResponse: Response was error: ",r.error),Promise.reject(new w(r))):Promise.resolve(r);var i=r.state;return(e=e||this._stateStore).remove(i).then(t=>{if(!t)throw l.error("OidcClient.processSignoutResponse: No matching state found in storage"),new Error("No matching state found in storage");let e=N.fromStorageString(t);return l.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),this._validator.validateSignoutResponse(e,r)})}clearStaleState(t){return l.debug("OidcClient.clearStaleState"),t=t||this._stateStore,N.clearStaleState(t,this.settings.staleStateAge)}}class L{constructor(){this._data={}}getItem(t){return l.debug("InMemoryWebStorage.getItem",t),this._data[t]}setItem(t,e){l.debug("InMemoryWebStorage.setItem",t),this._data[t]=e}removeItem(t){l.debug("InMemoryWebStorage.removeItem",t),delete this._data[t]}get length(){return Object.getOwnPropertyNames(this._data).length}key(t){return Object.getOwnPropertyNames(this._data)[t]}}class q{prepare(){return Promise.resolve(this)}navigate(t){return t&&t.url?(window.location=t.url,Promise.resolve()):(l.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))}get url(){return window.location.href}}const W=500,J="location=no,toolbar=no,width=500,height=500,left=100,top=100;",Y="_blank";class z{constructor(t){this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e});let e=t.popupWindowTarget||Y,r=t.popupWindowFeatures||J;this._popup=window.open("",e,r),this._popup&&(l.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),W))}get promise(){return this._promise}navigate(t){return this._popup?t&&t.url?(l.debug("PopupWindow.navigate: Setting URL in popup"),this._id=t.id,this._id&&(window["popupCallback_"+t.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=t.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise}_success(t){l.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(t)}_error(t){l.error("PopupWindow.error: ",t),this._cleanup(),this._reject(new Error(t))}close(){this._cleanup(!1)}_cleanup(t){l.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!t&&this._popup.close(),this._popup=null}_checkForPopupClosed(){this._popup&&!this._popup.closed||this._error("Popup window closed")}_callback(t,e){this._cleanup(e),t?(l.debug("PopupWindow.callback success"),this._success({url:t})):(l.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))}static notifyOpener(t,e,r){if(window.opener){if(t=t||window.location.href){var i=k.parseUrlFragment(t,r);if(i.state){var n="popupCallback_"+i.state,s=window.opener[n];s?(l.debug("PopupWindow.notifyOpener: passing url message to opener"),s(t,e)):l.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else l.warn("PopupWindow.notifyOpener: no state found in response url")}}else l.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")}}class G{prepare(t){let e=new z(t);return Promise.resolve(e)}callback(t,e,r){l.debug("PopupNavigator.callback");try{return z.notifyOpener(t,e,r),Promise.resolve()}catch(t){return Promise.reject(t)}}}const $=1e4;class X{constructor(t){this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e}),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.style.width=0,this._frame.style.height=0,window.document.body.appendChild(this._frame)}navigate(t){if(t&&t.url){let e=t.silentRequestTimeout||$;l.debug("IFrameWindow.navigate: Using timeout of:",e),this._timer=window.setTimeout(this._timeout.bind(this),e),this._frame.src=t.url}else this._error("No url provided");return this.promise}get promise(){return this._promise}_success(t){this._cleanup(),l.debug("IFrameWindow: Successful response from frame window"),this._resolve(t)}_error(t){this._cleanup(),l.error(t),this._reject(new Error(t))}close(){this._cleanup()}_cleanup(){this._frame&&(l.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)}_timeout(){l.debug("IFrameWindow.timeout"),this._error("Frame window timed out")}_message(t){if(l.debug("IFrameWindow.message"),this._timer&&t.origin===this._origin&&t.source===this._frame.contentWindow){let e=t.data;e?this._success({url:e}):this._error("Invalid response from frame")}}get _origin(){return location.protocol+"//"+location.host}static notifyParent(t){l.debug("IFrameWindow.notifyParent"),window.parent&&window!==window.parent&&(t=t||window.location.href)&&(l.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(t,location.protocol+"//"+location.host))}}class Z{prepare(t){let e=new X(t);return Promise.resolve(e)}callback(t){l.debug("IFrameNavigator.callback");try{return X.notifyParent(t),Promise.resolve()}catch(t){return Promise.reject(t)}}}const Q=60,tt=2e3;class et extends I{constructor({popup_redirect_uri:t,popup_post_logout_redirect_uri:e,popupWindowFeatures:r,popupWindowTarget:i,silent_redirect_uri:n,silentRequestTimeout:s,automaticSilentRenew:o=!1,includeIdTokenInSilentRenew:a=!0,monitorSession:h=!0,checkSessionInterval:u=tt,stopCheckSessionOnError:c=!0,revokeAccessTokenOnSignout:l=!1,accessTokenExpiringNotificationTime:d=Q,redirectNavigator:g=new q,popupNavigator:p=new G,iframeNavigator:y=new Z,userStore:m=new v({store:f.sessionStorage})}={}){super(arguments[0]),this._popup_redirect_uri=t,this._popup_post_logout_redirect_uri=e,this._popupWindowFeatures=r,this._popupWindowTarget=i,this._silent_redirect_uri=n,this._silentRequestTimeout=s,this._automaticSilentRenew=!!o,this._includeIdTokenInSilentRenew=a,this._accessTokenExpiringNotificationTime=d,this._monitorSession=h,this._checkSessionInterval=u,this._stopCheckSessionOnError=c,this._revokeAccessTokenOnSignout=l,this._redirectNavigator=g,this._popupNavigator=p,this._iframeNavigator=y,this._userStore=m}get popup_redirect_uri(){return this._popup_redirect_uri}get popup_post_logout_redirect_uri(){return this._popup_post_logout_redirect_uri}get popupWindowFeatures(){return this._popupWindowFeatures}get popupWindowTarget(){return this._popupWindowTarget}get silent_redirect_uri(){return this._silent_redirect_uri}get silentRequestTimeout(){return this._silentRequestTimeout}get automaticSilentRenew(){return!(!this.silent_redirect_uri||!this._automaticSilentRenew)}get includeIdTokenInSilentRenew(){return this._includeIdTokenInSilentRenew}get accessTokenExpiringNotificationTime(){return this._accessTokenExpiringNotificationTime}get monitorSession(){return this._monitorSession}get checkSessionInterval(){return this._checkSessionInterval}get stopCheckSessionOnError(){return this._stopCheckSessionOnError}get revokeAccessTokenOnSignout(){return this._revokeAccessTokenOnSignout}get redirectNavigator(){return this._redirectNavigator}get popupNavigator(){return this._popupNavigator}get iframeNavigator(){return this._iframeNavigator}get userStore(){return this._userStore}}class rt{constructor({id_token:t,session_state:e,access_token:r,token_type:i,scope:n,profile:s,expires_at:o,state:a}){this.id_token=t,this.session_state=e,this.access_token=r,this.token_type=i,this.scope=n,this.profile=s,this.expires_at=o,this.state=a}get expires_in(){if(this.expires_at){let t=parseInt(Date.now()/1e3);return this.expires_at-t}}get expired(){let t=this.expires_in;if(void 0!==t)return t<=0}get scopes(){return(this.scope||"").split(" ")}toStorageString(){return l.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})}static fromStorageString(t){return l.debug("User.fromStorageString"),new rt(JSON.parse(t))}}class it{constructor(t){this._name=t,this._callbacks=[]}addHandler(t){this._callbacks.push(t)}removeHandler(t){var e=this._callbacks.findIndex(e=>e===t);e>=0&&this._callbacks.splice(e,1)}raise(...t){l.debug("Event: Raising event: "+this._name);for(let e=0;e<this._callbacks.length;e++)this._callbacks[e](...t)}}const nt=5;class st extends it{constructor(t,e=f.timer,r){super(t),this._timer=e,this._nowFunc=r||(()=>Date.now()/1e3)}get now(){return parseInt(this._nowFunc())}init(t){t<=0&&(t=1),t=parseInt(t);var e=this.now+t;if(this.expiration===e&&this._timerHandle)l.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);else{this.cancel(),l.debug("Timer.init timer "+this._name+" for duration:",t),this._expiration=e;var r=nt;t<r&&(r=t),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*r)}}get expiration(){return this._expiration}cancel(){this._timerHandle&&(l.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)}_callback(){var t=this._expiration-this.now;l.debug("Timer.callback; "+this._name+" timer expires in:",t),this._expiration<=this.now&&(this.cancel(),super.raise())}}const ot=60;class at{constructor({accessTokenExpiringNotificationTime:t=ot,accessTokenExpiringTimer:e=new st("Access token expiring"),accessTokenExpiredTimer:r=new st("Access token expired")}={}){this._accessTokenExpiringNotificationTime=t,this._accessTokenExpiring=e,this._accessTokenExpired=r}load(t){if(t.access_token&&void 0!==t.expires_in){let e=t.expires_in;if(l.debug("AccessTokenEvents.load: access token present, remaining duration:",e),e>0){let t=e-this._accessTokenExpiringNotificationTime;t<=0&&(t=1),l.debug("AccessTokenEvents.load: registering expiring timer in:",t),this._accessTokenExpiring.init(t)}else l.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();let r=e+1;l.debug("AccessTokenEvents.load: registering expired timer in:",r),this._accessTokenExpired.init(r)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()}unload(){l.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()}addAccessTokenExpiring(t){this._accessTokenExpiring.addHandler(t)}removeAccessTokenExpiring(t){this._accessTokenExpiring.removeHandler(t)}addAccessTokenExpired(t){this._accessTokenExpired.addHandler(t)}removeAccessTokenExpired(t){this._accessTokenExpired.removeHandler(t)}}class ht extends at{constructor(t){super(t),this._userLoaded=new it("User loaded"),this._userUnloaded=new it("User unloaded"),this._silentRenewError=new it("Silent renew error"),this._userSignedOut=new it("User signed out"),this._userSessionChanged=new it("User session changed")}load(t,e=!0){l.debug("UserManagerEvents.load"),super.load(t),e&&this._userLoaded.raise(t)}unload(){l.debug("UserManagerEvents.unload"),super.unload(),this._userUnloaded.raise()}addUserLoaded(t){this._userLoaded.addHandler(t)}removeUserLoaded(t){this._userLoaded.removeHandler(t)}addUserUnloaded(t){this._userUnloaded.addHandler(t)}removeUserUnloaded(t){this._userUnloaded.removeHandler(t)}addSilentRenewError(t){this._silentRenewError.addHandler(t)}removeSilentRenewError(t){this._silentRenewError.removeHandler(t)}_raiseSilentRenewError(t){l.debug("UserManagerEvents._raiseSilentRenewError",t.message),this._silentRenewError.raise(t)}addUserSignedOut(t){this._userSignedOut.addHandler(t)}removeUserSignedOut(t){this._userSignedOut.removeHandler(t)}_raiseUserSignedOut(t){l.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise(t)}addUserSessionChanged(t){this._userSessionChanged.addHandler(t)}removeUserSessionChanged(t){this._userSessionChanged.removeHandler(t)}_raiseUserSessionChanged(t){l.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise(t)}}class ut{constructor(t){this._userManager=t}start(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then(t=>{}).catch(t=>{l.error("SilentRenewService.start: Error from getUser:",t.message)}))}stop(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)}_tokenExpiring(){this._userManager.signinSilent().then(t=>{l.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")},t=>{l.error("SilentRenewService._tokenExpiring: Error from signinSilent:",t.message),this._userManager.events._raiseSilentRenewError(t)})}}const ct=2e3;class lt{constructor(t,e,r,i,n=!0){this._callback=t,this._client_id=e,this._url=r,this._interval=i||ct,this._stopOnError=n;var s=r.indexOf("/",r.indexOf("//")+2);this._frame_origin=r.substr(0,s),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.style.width=0,this._frame.style.height=0,this._frame.src=r}load(){return new Promise(t=>{this._frame.onload=(()=>{t()}),window.document.body.appendChild(this._frame),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1)})}_message(t){t.origin===this._frame_origin&&t.source===this._frame.contentWindow&&("error"===t.data?(l.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===t.data?(l.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):l.debug("CheckSessionIFrame: "+t.data+" message from check session op iframe"))}start(t){if(this._session_state!==t){l.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=t;let e=()=>{this._frame.contentWindow.postMessage(this._client_id+" "+this._session_state,this._frame_origin)};e(),this._timer=window.setInterval(e,this._interval)}}stop(){this._session_state=null,this._timer&&(l.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)}}class dt{constructor(t,e=lt){if(!t)throw l.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=t,this._CheckSessionIFrameCtor=e,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),this._userManager.getUser().then(t=>{t&&this._start(t)}).catch(t=>{l.error("SessionMonitor ctor: error from getUser:",t.message)})}get _settings(){return this._userManager.settings}get _metadataService(){return this._userManager.metadataService}get _client_id(){return this._settings.client_id}get _checkSessionInterval(){return this._settings.checkSessionInterval}get _stopCheckSessionOnError(){return this._settings.stopCheckSessionOnError}_start(t){let e=t.session_state;e&&(this._sub=t.profile.sub,this._sid=t.profile.sid,l.debug("SessionMonitor._start: session_state:",e,", sub:",this._sub),this._checkSessionIFrame?this._checkSessionIFrame.start(e):this._metadataService.getCheckSessionIframe().then(t=>{if(t){l.debug("SessionMonitor._start: Initializing check session iframe");let r=this._client_id,i=this._checkSessionInterval,n=this._stopCheckSessionOnError;this._checkSessionIFrame=new this._CheckSessionIFrameCtor(this._callback.bind(this),r,t,i,n),this._checkSessionIFrame.load().then(()=>{this._checkSessionIFrame.start(e)})}else l.warn("SessionMonitor._start: No check session iframe found in the metadata")}).catch(t=>{l.error("SessionMonitor._start: Error from getCheckSessionIframe:",t.message)}))}_stop(){this._sub=null,this._sid=null,this._checkSessionIFrame&&(l.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop())}_callback(){this._userManager.querySessionStatus().then(t=>{var e=!0;t?t.sub===this._sub?(e=!1,this._checkSessionIFrame.start(t.session_state),t.sid===this._sid?l.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",t.session_state):(l.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",t.session_state),this._userManager.events._raiseUserSessionChanged())):l.debug("SessionMonitor._callback: Different subject signed into OP:",t.sub):l.debug("SessionMonitor._callback: Subject no longer signed into OP"),e&&(l.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),this._userManager.events._raiseUserSignedOut())}).catch(t=>{l.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",t.message),this._userManager.events._raiseUserSignedOut()})}}const gt="access_token";class pt{constructor(t,e=f.XMLHttpRequest,r=S){if(!t)throw l.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=t,this._XMLHttpRequestCtor=e,this._metadataService=new r(this._settings)}revoke(t,e){if(!t)throw l.error("TokenRevocationClient.revoke: No accessToken provided"),new Error("No accessToken provided.");return this._metadataService.getRevocationEndpoint().then(r=>{if(r){l.error("TokenRevocationClient.revoke: Revoking access token");var i=this._settings.client_id,n=this._settings.client_secret;return this._revoke(r,i,n,t)}if(e)throw l.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")})}_revoke(t,e,r,i){return new Promise((n,s)=>{var o=new this._XMLHttpRequestCtor;o.open("POST",t),o.onload=(()=>{l.debug("TokenRevocationClient.revoke: HTTP response received, status",o.status),200===o.status?n():s(Error(o.statusText+" ("+o.status+")"))});var a="client_id="+encodeURIComponent(e);r&&(a+="&client_secret="+encodeURIComponent(r)),a+="&token_type_hint="+encodeURIComponent(gt),a+="&token="+encodeURIComponent(i),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(a)})}}class ft extends K{constructor(t={},e=ut,r=dt,i=pt){t instanceof et||(t=new et(t)),super(t),this._events=new ht(t),this._silentRenewService=new e(this),this.settings.automaticSilentRenew&&(l.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),this.startSilentRenew()),this.settings.monitorSession&&(l.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),this._sessionMonitor=new r(this)),this._tokenRevocationClient=new i(this._settings)}get _redirectNavigator(){return this.settings.redirectNavigator}get _popupNavigator(){return this.settings.popupNavigator}get _iframeNavigator(){return this.settings.iframeNavigator}get _userStore(){return this.settings.userStore}get events(){return this._events}getUser(){return this._loadUser().then(t=>t?(l.info("UserManager.getUser: user loaded"),this._events.load(t,!1),t):(l.info("UserManager.getUser: user not found in storage"),null))}removeUser(){return this.storeUser(null).then(()=>{l.info("UserManager.removeUser: user removed from storage"),this._events.unload()})}signinRedirect(t){return this._signinStart(t,this._redirectNavigator).then(()=>{l.info("UserManager.signinRedirect: successful")})}signinRedirectCallback(t){return this._signinEnd(t||this._redirectNavigator.url).then(t=>(t&&(t.profile&&t.profile.sub?l.info("UserManager.signinRedirectCallback: successful, signed in sub: ",t.profile.sub):l.info("UserManager.signinRedirectCallback: no sub")),t))}signinPopup(t={}){let e=t.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return e?(t.redirect_uri=e,t.display="popup",this._signin(t,this._popupNavigator,{startUrl:e,popupWindowFeatures:t.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:t.popupWindowTarget||this.settings.popupWindowTarget}).then(t=>(t&&(t.profile&&t.profile.sub?l.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",t.profile.sub):l.info("UserManager.signinPopup: no sub")),t))):(l.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))}signinPopupCallback(t){return this._signinCallback(t,this._popupNavigator).then(t=>(t&&(t.profile&&t.profile.sub?l.info("UserManager.signinPopupCallback: successful, signed in sub: ",t.profile.sub):l.info("UserManager.signinPopupCallback: no sub")),t)).catch(t=>{l.error("UserManager.signinPopupCallback error: "+t&&t.message)})}signinSilent(t={}){let e,r=t.redirect_uri||this.settings.silent_redirect_uri;return r?(t.redirect_uri=r,t.prompt="none",(e=t.id_token_hint||!this.settings.includeIdTokenInSilentRenew?Promise.resolve():this._loadUser().then(e=>{t.id_token_hint=e&&e.id_token})).then(()=>this._signin(t,this._iframeNavigator,{startUrl:r,silentRequestTimeout:t.silentRequestTimeout||this.settings.silentRequestTimeout})).then(t=>(t&&(t.profile&&t.profile.sub?l.info("UserManager.signinSilent: successful, signed in sub: ",t.profile.sub):l.info("UserManager.signinSilent: no sub")),t))):(l.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))}signinSilentCallback(t){return this._signinCallback(t,this._iframeNavigator).then(t=>(t&&(t.profile&&t.profile.sub?l.info("UserManager.signinSilentCallback: successful, signed in sub: ",t.profile.sub):l.info("UserManager.signinSilentCallback: no sub")),t))}querySessionStatus(t={}){let e=t.redirect_uri||this.settings.silent_redirect_uri;return e?(t.redirect_uri=e,t.prompt="none",t.response_type="id_token",t.scope="openid",this._signinStart(t,this._iframeNavigator,{startUrl:e,silentRequestTimeout:t.silentRequestTimeout||this.settings.silentRequestTimeout}).then(t=>this.processSigninResponse(t.url).then(t=>{if(l.debug("UserManager.querySessionStatus: got signin response"),t.session_state&&t.profile.sub&&t.profile.sid)return l.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",t.profile.sub),{session_state:t.session_state,sub:t.profile.sub,sid:t.profile.sid};l.info("querySessionStatus successful, user not authenticated")}))):(l.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))}_signin(t,e,r={}){return this._signinStart(t,e,r).then(t=>this._signinEnd(t.url))}_signinStart(t,e,r={}){return e.prepare(r).then(e=>(l.debug("UserManager._signinStart: got navigator window handle"),this.createSigninRequest(t).then(t=>(l.debug("UserManager._signinStart: got signin request"),r.url=t.url,r.id=t.state.id,e.navigate(r))).catch(t=>{throw e.close&&(l.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),e.close()),t})))}_signinEnd(t){return this.processSigninResponse(t).then(t=>{l.debug("UserManager._signinEnd: got signin response");let e=new rt(t);return this.storeUser(e).then(()=>(l.debug("UserManager._signinEnd: user stored"),this._events.load(e),e))})}_signinCallback(t,e){return l.debug("UserManager._signinCallback"),e.callback(t)}signoutRedirect(t={}){let e=t.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return e&&(t.post_logout_redirect_uri=e),this._signoutStart(t,this._redirectNavigator).then(()=>{l.info("UserManager.signoutRedirect: successful")})}signoutRedirectCallback(t){return this._signoutEnd(t||this._redirectNavigator.url).then(t=>(l.info("UserManager.signoutRedirectCallback: successful"),t))}signoutPopup(t={}){let e=t.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return t.post_logout_redirect_uri=e,t.display="popup",t.post_logout_redirect_uri&&(t.state=t.state||{}),this._signout(t,this._popupNavigator,{startUrl:e,popupWindowFeatures:t.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:t.popupWindowTarget||this.settings.popupWindowTarget}).then(()=>{l.info("UserManager.signinPopup: successful")})}signoutPopupCallback(t,e){void 0===e&&"boolean"==typeof t&&(t=null,e=!0);return this._popupNavigator.callback(t,e,"?").then(()=>{l.info("UserManager.signoutPopupCallback: successful")})}_signout(t,e,r={}){return this._signoutStart(t,e,r).then(t=>this._signoutEnd(t.url))}_signoutStart(t={},e,r={}){return e.prepare(r).then(e=>(l.debug("UserManager._signoutStart: got navigator window handle"),this._loadUser().then(i=>{return l.debug("UserManager._signoutStart: loaded current user from storage"),(this._settings.revokeAccessTokenOnSignout?this._revokeInternal(i):Promise.resolve()).then(()=>{var n=t.id_token_hint||i&&i.id_token;return n&&(l.debug("UserManager._signoutStart: Setting id_token into signout request"),t.id_token_hint=n),this.removeUser().then(()=>(l.debug("UserManager._signoutStart: user removed, creating signout request"),this.createSignoutRequest(t).then(t=>(l.debug("UserManager._signoutStart: got signout request"),r.url=t.url,t.state&&(r.id=t.state.id),e.navigate(r)))))})}).catch(t=>{throw e.close&&(l.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),e.close()),t})))}_signoutEnd(t){return this.processSignoutResponse(t).then(t=>(l.debug("UserManager._signoutEnd: got signout response"),t))}revokeAccessToken(){return this._loadUser().then(t=>this._revokeInternal(t,!0).then(e=>{if(e)return l.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),t.access_token=null,t.expires_at=null,t.token_type=null,this.storeUser(t).then(()=>{l.debug("UserManager.revokeAccessToken: user stored"),this._events.load(t)})})).then(()=>{l.info("UserManager.revokeAccessToken: access token revoked successfully")})}_revokeInternal(t,e){var r=t&&t.access_token;return!r||r.indexOf(".")>=0?(l.debug("UserManager.revokeAccessToken: no need to revoke due to no user, token, or JWT format"),Promise.resolve(!1)):this._tokenRevocationClient.revoke(r,e).then(()=>!0)}startSilentRenew(){this._silentRenewService.start()}stopSilentRenew(){this._silentRenewService.stop()}get _userStoreKey(){return`user:${this.settings.authority}:${this.settings.client_id}`}_loadUser(){return this._userStore.get(this._userStoreKey).then(t=>t?(l.debug("UserManager._loadUser: user storageString loaded"),rt.fromStorageString(t)):(l.debug("UserManager._loadUser: no user storageString"),null))}storeUser(t){if(t){l.debug("UserManager.storeUser: storing user");var e=t.toStorageString();return this._userStore.set(this._userStoreKey,e)}return l.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)}}const vt="location=no,toolbar=no,zoom=no",yt="_blank";class mt{constructor(t){this._promise=new Promise((t,e)=>{this._resolve=t,this._reject=e}),this.features=t.popupWindowFeatures||vt,this.target=t.popupWindowTarget||yt,this.redirect_uri=t.startUrl,l.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}_isInAppBrowserInstalled(t){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some(function(e){return t.hasOwnProperty(e)})}navigate(t){if(t&&t.url){if(!window.cordova)return this._error("cordova is undefined");var e=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(e))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(t.url,this.target,this.features),this._popup?(l.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise}get promise(){return this._promise}_loadStartCallback(t){0===t.url.indexOf(this.redirect_uri)&&this._success({url:t.url})}_exitCallback(t){this._error(t)}_success(t){this._cleanup(),l.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(t)}_error(t){this._cleanup(),l.error(t),this._reject(new Error(t))}close(){this._cleanup()}_cleanup(){this._popup&&(l.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null}}class St{prepare(t){let e=new mt(t);return Promise.resolve(e)}}class Ft{prepare(t){t.popupWindowFeatures="hidden=yes";let e=new mt(t);return Promise.resolve(e)}}r.d(e,"Log",function(){return l}),r.d(e,"OidcClient",function(){return K}),r.d(e,"OidcClientSettings",function(){return I}),r.d(e,"WebStorageStateStore",function(){return v}),r.d(e,"InMemoryWebStorage",function(){return L}),r.d(e,"UserManager",function(){return ft}),r.d(e,"AccessTokenEvents",function(){return at}),r.d(e,"MetadataService",function(){return S}),r.d(e,"CordovaPopupNavigator",function(){return St}),r.d(e,"CordovaIFrameNavigator",function(){return Ft}),r.d(e,"CheckSessionIFrame",function(){return lt}),r.d(e,"TokenRevocationClient",function(){return pt}),r.d(e,"SessionMonitor",function(){return dt}),r.d(e,"Global",function(){return f}),r.d(e,"User",function(){return rt})},16:function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},17:function(t,e){e.read=function(t,e,r,i,n){var s,o,a=8*n-i-1,h=(1<<a)-1,u=h>>1,c=-7,l=r?n-1:0,d=r?-1:1,g=t[e+l];for(l+=d,s=g&(1<<-c)-1,g>>=-c,c+=a;c>0;s=256*s+t[e+l],l+=d,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=i;c>0;o=256*o+t[e+l],l+=d,c-=8);if(0===s)s=1-u;else{if(s===h)return o?NaN:1/0*(g?-1:1);o+=Math.pow(2,i),s-=u}return(g?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,r,i,n,s){var o,a,h,u=8*s-n-1,c=(1<<u)-1,l=c>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:s-1,p=i?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+l>=1?d/h:d*Math.pow(2,1-l))*h>=2&&(o++,h/=2),o+l>=c?(a=0,o=c):o+l>=1?(a=(e*h-1)*Math.pow(2,n),o+=l):(a=e*Math.pow(2,l-1)*Math.pow(2,n),o=0));n>=8;t[r+g]=255&a,g+=p,a/=256,n-=8);for(o=o<<n|a,u+=n;u>0;t[r+g]=255&o,g+=p,o/=256,u-=8);t[r+g-p]|=128*f}},18:function(t,e,r){"use strict";e.byteLength=function(t){var e=u(t),r=e[0],i=e[1];return 3*(r+i)/4-i},e.toByteArray=function(t){for(var e,r=u(t),i=r[0],o=r[1],a=new s(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),h=0,c=o>0?i-4:i,l=0;l<c;l+=4)e=n[t.charCodeAt(l)]<<18|n[t.charCodeAt(l+1)]<<12|n[t.charCodeAt(l+2)]<<6|n[t.charCodeAt(l+3)],a[h++]=e>>16&255,a[h++]=e>>8&255,a[h++]=255&e;2===o&&(e=n[t.charCodeAt(l)]<<2|n[t.charCodeAt(l+1)]>>4,a[h++]=255&e);1===o&&(e=n[t.charCodeAt(l)]<<10|n[t.charCodeAt(l+1)]<<4|n[t.charCodeAt(l+2)]>>2,a[h++]=e>>8&255,a[h++]=255&e);return a},e.fromByteArray=function(t){for(var e,r=t.length,n=r%3,s=[],o=0,a=r-n;o<a;o+=16383)s.push(c(t,o,o+16383>a?a:o+16383));1===n?(e=t[r-1],s.push(i[e>>2]+i[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],s.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"="));return s.join("")};for(var i=[],n=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,h=o.length;a<h;++a)i[a]=o[a],n[o.charCodeAt(a)]=a;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(t,e,r){for(var n,s,o=[],a=e;a<r;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),o.push(i[(s=n)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},19:function(t,e,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=r(18),n=r(17),s=r(16);function o(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:(null===t&&(t=new h(e)),t.length=e),t}function h(t,e,r){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return l(this,t)}return u(this,t,e,r)}function u(t,e,r,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,i){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,r):new Uint8Array(e,r,i);h.TYPED_ARRAY_SUPPORT?(t=e).__proto__=h.prototype:t=d(t,e);return t}(t,e,r,i):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!h.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|p(e,r),n=(t=a(t,i)).write(e,r);n!==i&&(t=t.slice(0,n));return t}(t,e,r):function(t,e){if(h.isBuffer(e)){var r=0|g(e.length);return 0===(t=a(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?a(t,0):d(t,e);if("Buffer"===e.type&&s(e.data))return d(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function l(t,e){if(c(e),t=a(t,e<0?0:0|g(e)),!h.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function d(t,e){var r=e.length<0?0:0|g(e.length);t=a(t,r);for(var i=0;i<r;i+=1)t[i]=255&e[i];return t}function g(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(h.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return M(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return V(t).length;default:if(i)return M(t).length;e=(""+e).toLowerCase(),i=!0}}function f(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function v(t,e,r,i,n){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof e&&(e=h.from(e,i)),h.isBuffer(e))return 0===e.length?-1:y(t,e,r,i,n);if("number"==typeof e)return e&=255,h.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):y(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function y(t,e,r,i,n){var s,o=1,a=t.length,h=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(n){var c=-1;for(s=r;s<a;s++)if(u(t,s)===u(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===h)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(r+h>a&&(r=a-h),s=r;s>=0;s--){for(var l=!0,d=0;d<h;d++)if(u(t,s+d)!==u(e,d)){l=!1;break}if(l)return s}return-1}function m(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i))>n&&(i=n):i=n;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[r+o]=a}return o}function S(t,e,r,i){return K(M(e,t.length-r),t,r,i)}function F(t,e,r,i){return K(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,i)}function w(t,e,r,i){return F(t,e,r,i)}function b(t,e,r,i){return K(V(e),t,r,i)}function E(t,e,r,i){return K(function(t,e){for(var r,i,n,s=[],o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}(e,t.length-r),t,r,i)}function _(t,e,r){return 0===e&&r===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,r))}function x(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var s,o,a,h,u=t[n],c=null,l=u>239?4:u>223?3:u>191?2:1;if(n+l<=r)switch(l){case 1:u<128&&(c=u);break;case 2:128==(192&(s=t[n+1]))&&(h=(31&u)<<6|63&s)>127&&(c=h);break;case 3:s=t[n+1],o=t[n+2],128==(192&s)&&128==(192&o)&&(h=(15&u)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(c=h);break;case 4:s=t[n+1],o=t[n+2],a=t[n+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(c=h)}null===c?(c=65533,l=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),n+=l}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);var r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=A));return r}(i)}e.Buffer=h,e.SlowBuffer=function(t){+t!=t&&(t=0);return h.alloc(+t)},e.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),h.poolSize=8192,h._augment=function(t){return t.__proto__=h.prototype,t},h.from=function(t,e,r){return u(null,t,e,r)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(t,e,r){return function(t,e,r,i){return c(e),e<=0?a(t,e):void 0!==r?"string"==typeof i?a(t,e).fill(r,i):a(t,e).fill(r):a(t,e)}(null,t,e,r)},h.allocUnsafe=function(t){return l(null,t)},h.allocUnsafeSlow=function(t){return l(null,t)},h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,i=e.length,n=0,s=Math.min(r,i);n<s;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!s(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=h.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){var o=t[r];if(!h.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,n),n+=o.length}return i},h.byteLength=p,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)f(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)f(this,e,e+3),f(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)f(this,e,e+7),f(this,e+1,e+6),f(this,e+2,e+5),f(this,e+3,e+4);return this},h.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?x(this,0,t):function(t,e,r){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,r);case"utf8":case"utf-8":return x(this,e,r);case"ascii":return P(this,e,r);case"latin1":case"binary":return C(this,e,r);case"base64":return _(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t,e,r,i,n){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,i>>>=0,n>>>=0,this===t)return 0;for(var s=n-i,o=r-e,a=Math.min(s,o),u=this.slice(i,n),c=t.slice(e,r),l=0;l<a;++l)if(u[l]!==c[l]){s=u[l],o=c[l];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},h.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},h.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},h.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return S(this,t,e,r);case"ascii":return F(this,t,e,r);case"latin1":case"binary":return w(this,t,e,r);case"base64":return b(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function P(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}function C(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function R(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=e;s<r;++s)n+=O(t[s]);return n}function T(t,e,r){for(var i=t.slice(e,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function D(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function I(t,e,r,i,n,s){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function k(t,e,r,i){e<0&&(e=65535+e+1);for(var n=0,s=Math.min(t.length-r,2);n<s;++n)t[r+n]=(e&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function B(t,e,r,i){e<0&&(e=4294967295+e+1);for(var n=0,s=Math.min(t.length-r,4);n<s;++n)t[r+n]=e>>>8*(i?n:3-n)&255}function N(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function H(t,e,r,i,s){return s||N(t,0,r,4),n.write(t,e,r,i,23,4),r+4}function j(t,e,r,i,s){return s||N(t,0,r,8),n.write(t,e,r,i,52,8),r+8}h.prototype.slice=function(t,e){var r,i=this.length;if(t=~~t,e=void 0===e?i:~~e,t<0?(t+=i)<0&&(t=0):t>i&&(t=i),e<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=h.prototype;else{var n=e-t;r=new h(n,void 0);for(var s=0;s<n;++s)r[s]=this[s+t]}return r},h.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||D(t,e,this.length);for(var i=this[t],n=1,s=0;++s<e&&(n*=256);)i+=this[t+s]*n;return i},h.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||D(t,e,this.length);for(var i=this[t+--e],n=1;e>0&&(n*=256);)i+=this[t+--e]*n;return i},h.prototype.readUInt8=function(t,e){return e||D(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||D(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||D(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||D(t,e,this.length);for(var i=this[t],n=1,s=0;++s<e&&(n*=256);)i+=this[t+s]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*e)),i},h.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||D(t,e,this.length);for(var i=e,n=1,s=this[t+--i];i>0&&(n*=256);)s+=this[t+--i]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*e)),s},h.prototype.readInt8=function(t,e){return e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||D(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt16BE=function(t,e){e||D(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt32LE=function(t,e){return e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||D(t,4,this.length),n.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||D(t,4,this.length),n.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||D(t,8,this.length),n.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||D(t,8,this.length),n.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,r,i){(t=+t,e|=0,r|=0,i)||I(this,t,e,r,Math.pow(2,8*r)-1,0);var n=1,s=0;for(this[e]=255&t;++s<r&&(n*=256);)this[e+s]=t/n&255;return e+r},h.prototype.writeUIntBE=function(t,e,r,i){(t=+t,e|=0,r|=0,i)||I(this,t,e,r,Math.pow(2,8*r)-1,0);var n=r-1,s=1;for(this[e+n]=255&t;--n>=0&&(s*=256);)this[e+n]=t/s&255;return e+r},h.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):B(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},h.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e|=0,!i){var n=Math.pow(2,8*r-1);I(this,t,e,r,n-1,-n)}var s=0,o=1,a=0;for(this[e]=255&t;++s<r&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+r},h.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e|=0,!i){var n=Math.pow(2,8*r-1);I(this,t,e,r,n-1,-n)}var s=r-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+r},h.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):k(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):k(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):B(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||I(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):B(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,r){return H(this,t,e,!0,r)},h.prototype.writeFloatBE=function(t,e,r){return H(this,t,e,!1,r)},h.prototype.writeDoubleLE=function(t,e,r){return j(this,t,e,!0,r)},h.prototype.writeDoubleBE=function(t,e,r){return j(this,t,e,!1,r)},h.prototype.copy=function(t,e,r,i){if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n,s=i-r;if(this===t&&r<e&&e<i)for(n=s-1;n>=0;--n)t[n+e]=this[n+r];else if(s<1e3||!h.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)t[n+e]=this[n+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+s),e);return s},h.prototype.fill=function(t,e,r,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!h.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=h.isBuffer(t)?t:M(new h(t,i).toString()),a=o.length;for(s=0;s<r-e;++s)this[s+e]=o[s%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function O(t){return t<16?"0"+t.toString(16):t.toString(16)}function M(t,e){var r;e=e||1/0;for(var i=t.length,n=null,s=[],o=0;o<i;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function V(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function K(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}}).call(this,r(10))},38:function(t,e,r){"use strict";new(r(15).UserManager)({}).signinPopupCallback()},4:function(t,e,r){(function(t){var r={userAgent:!1},i={};
/*!
Copyright (c) 2011, Yahoo! Inc. All rights reserved.
Code licensed under the BSD License:
http://developer.yahoo.com/yui/license.html
version: 2.9.0
*/
if(void 0===n)var n={};n.lang={extend:function(t,e,i){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var n=function(){};if(n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),i){var s;for(s in i)t.prototype[s]=i[s];var o=function(){},a=["toString","valueOf"];try{/MSIE/.test(r.userAgent)&&(o=function(t,e){for(s=0;s<a.length;s+=1){var r=a[s],i=e[r];"function"==typeof i&&i!=Object.prototype[r]&&(t[r]=i)}})}catch(t){}o(t.prototype,i)}}};
/*! CryptoJS v3.1.2 core-fix.js
 * code.google.com/p/crypto-js
 * (c) 2009-2013 by Jeff Mott. All rights reserved.
 * code.google.com/p/crypto-js/wiki/License
 * THIS IS FIX of 'core.js' to fix Hmac issue.
 * https://code.google.com/p/crypto-js/issues/detail?id=84
 * https://crypto-js.googlecode.com/svn-history/r667/branches/3.x/src/core.js
 */
var s,o,a,h,u,c,l,d,g,p,f,v=v||(s=Math,a=(o={}).lib={},h=a.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var r=new t;return e&&r.mixIn(e),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),u=a.WordArray=h.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:4*t.length},toString:function(t){return(t||l).stringify(this)},concat:function(t){var e=this.words,r=t.words,i=this.sigBytes,n=t.sigBytes;if(this.clamp(),i%4)for(var s=0;s<n;s++){var o=r[s>>>2]>>>24-s%4*8&255;e[i+s>>>2]|=o<<24-(i+s)%4*8}else for(s=0;s<n;s+=4)e[i+s>>>2]=r[s>>>2];return this.sigBytes+=n,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=s.ceil(e/4)},clone:function(){var t=h.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],r=0;r<t;r+=4)e.push(4294967296*s.random()|0);return new u.init(e,t)}}),c=o.enc={},l=c.Hex={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n++){var s=e[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i+=2)r[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new u.init(r,e/2)}},d=c.Latin1={stringify:function(t){for(var e=t.words,r=t.sigBytes,i=[],n=0;n<r;n++){var s=e[n>>>2]>>>24-n%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,r=[],i=0;i<e;i++)r[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new u.init(r,e)}},g=c.Utf8={stringify:function(t){try{return decodeURIComponent(escape(d.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return d.parse(unescape(encodeURIComponent(t)))}},p=a.BufferedBlockAlgorithm=h.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=g.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,r=e.words,i=e.sigBytes,n=this.blockSize,o=i/(4*n),a=(o=t?s.ceil(o):s.max((0|o)-this._minBufferSize,0))*n,h=s.min(4*a,i);if(a){for(var c=0;c<a;c+=n)this._doProcessBlock(r,c);var l=r.splice(0,a);e.sigBytes-=h}return new u.init(l,h)},clone:function(){var t=h.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),a.Hasher=p.extend({cfg:h.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){p.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new f.HMAC.init(t,r).finalize(e)}}}),f=o.algo={},o);!function(t){var e,r=(e=v).lib,i=r.Base,n=r.WordArray;(e=e.x64={}).Word=i.extend({init:function(t,e){this.high=t,this.low=e}}),e.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=void 0!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,r=[],i=0;i<e;i++){var s=t[i];r.push(s.high),r.push(s.low)}return n.create(r,this.sigBytes)},clone:function(){for(var t=i.clone.call(this),e=t.words=this.words.slice(0),r=e.length,n=0;n<r;n++)e[n]=e[n].clone();return t}})}(),function(){var t=v,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,i=this._map;t.clamp(),t=[];for(var n=0;n<r;n+=3)for(var s=(e[n>>>2]>>>24-n%4*8&255)<<16|(e[n+1>>>2]>>>24-(n+1)%4*8&255)<<8|e[n+2>>>2]>>>24-(n+2)%4*8&255,o=0;4>o&&n+.75*o<r;o++)t.push(i.charAt(s>>>6*(3-o)&63));if(e=i.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var r=t.length,i=this._map;(n=i.charAt(64))&&(-1!=(n=t.indexOf(n))&&(r=n));for(var n=[],s=0,o=0;o<r;o++)if(o%4){var a=i.indexOf(t.charAt(o-1))<<o%4*2,h=i.indexOf(t.charAt(o))>>>6-o%4*2;n[s>>>2]|=(a|h)<<24-s%4*8,s++}return e.create(n,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){for(var e=v,r=(n=e.lib).WordArray,i=n.Hasher,n=e.algo,s=[],o=[],a=function(t){return 4294967296*(t-(0|t))|0},h=2,u=0;64>u;){var c;t:{c=h;for(var l=t.sqrt(c),d=2;d<=l;d++)if(!(c%d)){c=!1;break t}c=!0}c&&(8>u&&(s[u]=a(t.pow(h,.5))),o[u]=a(t.pow(h,1/3)),u++),h++}var g=[];n=n.SHA256=i.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(t,e){for(var r=this._hash.words,i=r[0],n=r[1],s=r[2],a=r[3],h=r[4],u=r[5],c=r[6],l=r[7],d=0;64>d;d++){if(16>d)g[d]=0|t[e+d];else{var p=g[d-15],f=g[d-2];g[d]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+g[d-7]+((f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10)+g[d-16]}p=l+((h<<26|h>>>6)^(h<<21|h>>>11)^(h<<7|h>>>25))+(h&u^~h&c)+o[d]+g[d],f=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&n^i&s^n&s),l=c,c=u,u=h,h=a+p|0,a=s,s=n,n=i,i=p+f|0}r[0]=r[0]+i|0,r[1]=r[1]+n|0,r[2]=r[2]+s|0,r[3]=r[3]+a|0,r[4]=r[4]+h|0,r[5]=r[5]+u|0,r[6]=r[6]+c|0,r[7]=r[7]+l|0},_doFinalize:function(){var e=this._data,r=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;return r[n>>>5]|=128<<24-n%32,r[14+(n+64>>>9<<4)]=t.floor(i/4294967296),r[15+(n+64>>>9<<4)]=i,e.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(n),e.HmacSHA256=i._createHmacHelper(n)}(Math),function(){function t(){return i.create.apply(i,arguments)}for(var e=v,r=e.lib.Hasher,i=(s=e.x64).Word,n=s.WordArray,s=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],a=[],h=0;80>h;h++)a[h]=t();s=s.SHA512=r.extend({_doReset:function(){this._hash=new n.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var r=(l=this._hash.words)[0],i=l[1],n=l[2],s=l[3],h=l[4],u=l[5],c=l[6],l=l[7],d=r.high,g=r.low,p=i.high,f=i.low,v=n.high,y=n.low,m=s.high,S=s.low,F=h.high,w=h.low,b=u.high,E=u.low,_=c.high,x=c.low,A=l.high,P=l.low,C=d,R=g,T=p,D=f,I=v,k=y,B=m,N=S,H=F,j=w,U=b,O=E,M=_,V=x,K=A,L=P,q=0;80>q;q++){var W=a[q];if(16>q)var J=W.high=0|t[e+2*q],Y=W.low=0|t[e+2*q+1];else{J=((Y=(J=a[q-15]).high)>>>1|(z=J.low)<<31)^(Y>>>8|z<<24)^Y>>>7;var z=(z>>>1|Y<<31)^(z>>>8|Y<<24)^(z>>>7|Y<<25),G=((Y=(G=a[q-2]).high)>>>19|($=G.low)<<13)^(Y<<3|$>>>29)^Y>>>6,$=($>>>19|Y<<13)^($<<3|Y>>>29)^($>>>6|Y<<26),X=(Y=a[q-7]).high,Z=(Q=a[q-16]).high,Q=Q.low;J=(J=(J=J+X+((Y=z+Y.low)>>>0<z>>>0?1:0))+G+((Y=Y+$)>>>0<$>>>0?1:0))+Z+((Y=Y+Q)>>>0<Q>>>0?1:0);W.high=J,W.low=Y}X=H&U^~H&M,Q=j&O^~j&V,W=C&T^C&I^T&I;var tt=R&D^R&k^D&k,et=(z=(C>>>28|R<<4)^(C<<30|R>>>2)^(C<<25|R>>>7),G=(R>>>28|C<<4)^(R<<30|C>>>2)^(R<<25|C>>>7),($=o[q]).high),rt=$.low;Z=(Z=(Z=(Z=K+((H>>>14|j<<18)^(H>>>18|j<<14)^(H<<23|j>>>9))+(($=L+((j>>>14|H<<18)^(j>>>18|H<<14)^(j<<23|H>>>9)))>>>0<L>>>0?1:0))+X+(($=$+Q)>>>0<Q>>>0?1:0))+et+(($=$+rt)>>>0<rt>>>0?1:0))+J+(($=$+Y)>>>0<Y>>>0?1:0),W=z+W+((Y=G+tt)>>>0<G>>>0?1:0),K=M,L=V,M=U,V=O,U=H,O=j,H=B+Z+((j=N+$|0)>>>0<N>>>0?1:0)|0,B=I,N=k,I=T,k=D,T=C,D=R,C=Z+W+((R=$+Y|0)>>>0<$>>>0?1:0)|0}g=r.low=g+R,r.high=d+C+(g>>>0<R>>>0?1:0),f=i.low=f+D,i.high=p+T+(f>>>0<D>>>0?1:0),y=n.low=y+k,n.high=v+I+(y>>>0<k>>>0?1:0),S=s.low=S+N,s.high=m+B+(S>>>0<N>>>0?1:0),w=h.low=w+j,h.high=F+H+(w>>>0<j>>>0?1:0),E=u.low=E+O,u.high=b+U+(E>>>0<O>>>0?1:0),x=c.low=x+V,c.high=_+M+(x>>>0<V>>>0?1:0),P=l.low=P+L,l.high=A+K+(P>>>0<L>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[30+(i+128>>>10<<5)]=Math.floor(r/4294967296),e[31+(i+128>>>10<<5)]=r,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=r.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=r._createHelper(s),e.HmacSHA512=r._createHmacHelper(s)}(),function(){var t=v,e=(n=t.x64).Word,r=n.WordArray,i=(n=t.algo).SHA512,n=n.SHA384=i.extend({_doReset:function(){this._hash=new r.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var t=i._doFinalize.call(this);return t.sigBytes-=16,t}});t.SHA384=i._createHelper(n),t.HmacSHA384=i._createHmacHelper(n)}();
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
var y,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S="=";function F(t){var e,r,i="";for(e=0;e+3<=t.length;e+=3)r=parseInt(t.substring(e,e+3),16),i+=m.charAt(r>>6)+m.charAt(63&r);if(e+1==t.length?(r=parseInt(t.substring(e,e+1),16),i+=m.charAt(r<<2)):e+2==t.length&&(r=parseInt(t.substring(e,e+2),16),i+=m.charAt(r>>2)+m.charAt((3&r)<<4)),S)for(;(3&i.length)>0;)i+=S;return i}function w(t){var e,r,i,n="",s=0;for(e=0;e<t.length&&t.charAt(e)!=S;++e)(i=m.indexOf(t.charAt(e)))<0||(0==s?(n+=R(i>>2),r=3&i,s=1):1==s?(n+=R(r<<2|i>>4),r=15&i,s=2):2==s?(n+=R(r),n+=R(i>>2),r=3&i,s=3):(n+=R(r<<2|i>>4),n+=R(15&i),s=0));return 1==s&&(n+=R(r<<2)),n}function b(t){var e,r=w(t),i=new Array;for(e=0;2*e<r.length;++e)i[e]=parseInt(r.substring(2*e,2*e+2),16);return i}function E(t,e,r){null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function _(){return new E(null)}"Microsoft Internet Explorer"==r.appName?(E.prototype.am=function(t,e,r,i,n,s){for(var o=32767&e,a=e>>15;--s>=0;){var h=32767&this[t],u=this[t++]>>15,c=a*h+u*o;n=((h=o*h+((32767&c)<<15)+r[i]+(1073741823&n))>>>30)+(c>>>15)+a*u+(n>>>30),r[i++]=1073741823&h}return n},y=30):"Netscape"!=r.appName?(E.prototype.am=function(t,e,r,i,n,s){for(;--s>=0;){var o=e*this[t++]+r[i]+n;n=Math.floor(o/67108864),r[i++]=67108863&o}return n},y=26):(E.prototype.am=function(t,e,r,i,n,s){for(var o=16383&e,a=e>>14;--s>=0;){var h=16383&this[t],u=this[t++]>>14,c=a*h+u*o;n=((h=o*h+((16383&c)<<14)+r[i]+n)>>28)+(c>>14)+a*u,r[i++]=268435455&h}return n},y=28),E.prototype.DB=y,E.prototype.DM=(1<<y)-1,E.prototype.DV=1<<y;E.prototype.FV=Math.pow(2,52),E.prototype.F1=52-y,E.prototype.F2=2*y-52;var x,A,P="0123456789abcdefghijklmnopqrstuvwxyz",C=new Array;for(x="0".charCodeAt(0),A=0;A<=9;++A)C[x++]=A;for(x="a".charCodeAt(0),A=10;A<36;++A)C[x++]=A;for(x="A".charCodeAt(0),A=10;A<36;++A)C[x++]=A;function R(t){return P.charAt(t)}function T(t,e){var r=C[t.charCodeAt(e)];return null==r?-1:r}function D(t){var e=_();return e.fromInt(t),e}function I(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function k(t){this.m=t}function B(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function N(t,e){return t&e}function H(t,e){return t|e}function j(t,e){return t^e}function U(t,e){return t&~e}function O(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function M(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function V(){}function K(t){return t}function L(t){this.r2=_(),this.q3=_(),E.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}k.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},k.prototype.revert=function(t){return t},k.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},k.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},k.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},B.prototype.convert=function(t){var e=_();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(E.ZERO)>0&&this.m.subTo(e,e),e},B.prototype.revert=function(t){var e=_();return t.copyTo(e),this.reduce(e),e},B.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],i=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},B.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},B.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},E.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},E.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},E.prototype.fromString=function(t,e){var r;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void this.fromRadix(t,e);r=2}this.t=0,this.s=0;for(var i=t.length,n=!1,s=0;--i>=0;){var o=8==r?255&t[i]:T(t,i);o<0?"-"==t.charAt(i)&&(n=!0):(n=!1,0==s?this[this.t++]=o:s+r>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),n&&E.ZERO.subTo(this,this)},E.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},E.prototype.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},E.prototype.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},E.prototype.lShiftTo=function(t,e){var r,i=t%this.DB,n=this.DB-i,s=(1<<n)-1,o=Math.floor(t/this.DB),a=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)e[r+o+1]=this[r]>>n|a,a=(this[r]&s)<<i;for(r=o-1;r>=0;--r)e[r]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()},E.prototype.rShiftTo=function(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)e.t=0;else{var i=t%this.DB,n=this.DB-i,s=(1<<i)-1;e[0]=this[r]>>i;for(var o=r+1;o<this.t;++o)e[o-r-1]|=(this[o]&s)<<n,e[o-r]=this[o]>>i;i>0&&(e[this.t-r-1]|=(this.s&s)<<n),e.t=this.t-r,e.clamp()}},E.prototype.subTo=function(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this[r]-t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i-=t[r],e[r++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[r++]=this.DV+i:i>0&&(e[r++]=i),e.t=r,e.clamp()},E.prototype.multiplyTo=function(t,e){var r=this.abs(),i=t.abs(),n=r.t;for(e.t=n+i.t;--n>=0;)e[n]=0;for(n=0;n<i.t;++n)e[n+r.t]=r.am(0,i[n],e,n,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&E.ZERO.subTo(e,e)},E.prototype.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},E.prototype.divRemTo=function(t,e,r){var i=t.abs();if(!(i.t<=0)){var n=this.abs();if(n.t<i.t)return null!=e&&e.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=_());var s=_(),o=this.s,a=t.s,h=this.DB-I(i[i.t-1]);h>0?(i.lShiftTo(h,s),n.lShiftTo(h,r)):(i.copyTo(s),n.copyTo(r));var u=s.t,c=s[u-1];if(0!=c){var l=c*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),d=this.FV/l,g=(1<<this.F1)/l,p=1<<this.F2,f=r.t,v=f-u,y=null==e?_():e;for(s.dlShiftTo(v,y),r.compareTo(y)>=0&&(r[r.t++]=1,r.subTo(y,r)),E.ONE.dlShiftTo(u,y),y.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--v>=0;){var m=r[--f]==c?this.DM:Math.floor(r[f]*d+(r[f-1]+p)*g);if((r[f]+=s.am(0,m,r,v,0,u))<m)for(s.dlShiftTo(v,y),r.subTo(y,r);r[f]<--m;)r.subTo(y,r)}null!=e&&(r.drShiftTo(u,e),o!=a&&E.ZERO.subTo(e,e)),r.t=u,r.clamp(),h>0&&r.rShiftTo(h,r),o<0&&E.ZERO.subTo(r,r)}}},E.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},E.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},E.prototype.exp=function(t,e){if(t>4294967295||t<1)return E.ONE;var r=_(),i=_(),n=e.convert(this),s=I(t)-1;for(n.copyTo(r);--s>=0;)if(e.sqrTo(r,i),(t&1<<s)>0)e.mulTo(i,n,r);else{var o=r;r=i,i=o}return e.revert(r)},E.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,n=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(r=this[o]>>a)>0&&(n=!0,s=R(r));o>=0;)a<e?(r=(this[o]&(1<<a)-1)<<e-a,r|=this[--o]>>(a+=this.DB-e)):(r=this[o]>>(a-=e)&i,a<=0&&(a+=this.DB,--o)),r>0&&(n=!0),n&&(s+=R(r));return n?s:"0"},E.prototype.negate=function(){var t=_();return E.ZERO.subTo(this,t),t},E.prototype.abs=function(){return this.s<0?this.negate():this},E.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},E.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+I(this[this.t-1]^this.s&this.DM)},E.prototype.mod=function(t){var e=_();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(E.ZERO)>0&&t.subTo(e,e),e},E.prototype.modPowInt=function(t,e){var r;return r=t<256||e.isEven()?new k(e):new B(e),this.exp(t,r)},E.ZERO=D(0),E.ONE=D(1),V.prototype.convert=K,V.prototype.revert=K,V.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},V.prototype.sqrTo=function(t,e){t.squareTo(e)},L.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=_();return t.copyTo(e),this.reduce(e),e},L.prototype.revert=function(t){return t},L.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},L.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},L.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var q=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],W=(1<<26)/q[q.length-1];
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function J(){this.i=0,this.j=0,this.S=new Array}E.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},E.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=D(r),n=_(),s=_(),o="";for(this.divRemTo(i,n,s);n.signum()>0;)o=(r+s.intValue()).toString(t).substr(1)+o,n.divRemTo(i,n,s);return s.intValue().toString(t)+o},E.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var r=this.chunkSize(e),i=Math.pow(e,r),n=!1,s=0,o=0,a=0;a<t.length;++a){var h=T(t,a);h<0?"-"==t.charAt(a)&&0==this.signum()&&(n=!0):(o=e*o+h,++s>=r&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),n&&E.ZERO.subTo(this,this)},E.prototype.fromNumber=function(t,e,r){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(E.ONE.shiftLeft(t-1),H,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(E.ONE.shiftLeft(t-1),this);else{var i=new Array,n=7&t;i.length=1+(t>>3),e.nextBytes(i),n>0?i[0]&=(1<<n)-1:i[0]=0,this.fromString(i,256)}},E.prototype.bitwiseTo=function(t,e,r){var i,n,s=Math.min(t.t,this.t);for(i=0;i<s;++i)r[i]=e(this[i],t[i]);if(t.t<this.t){for(n=t.s&this.DM,i=s;i<this.t;++i)r[i]=e(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=s;i<t.t;++i)r[i]=e(n,t[i]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()},E.prototype.changeBit=function(t,e){var r=E.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r},E.prototype.addTo=function(t,e){for(var r=0,i=0,n=Math.min(t.t,this.t);r<n;)i+=this[r]+t[r],e[r++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;r<this.t;)i+=this[r],e[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<t.t;)i+=t[r],e[r++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[r++]=i:i<-1&&(e[r++]=this.DV+i),e.t=r,e.clamp()},E.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},E.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},E.prototype.multiplyLowerTo=function(t,e,r){var i,n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r[--n]=0;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t[n],r,n,0,e-n);r.clamp()},E.prototype.multiplyUpperTo=function(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r[this.t+i-e]=this.am(e-i,t[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)},E.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this[i])%t;return r},E.prototype.millerRabin=function(t){var e=this.subtract(E.ONE),r=e.getLowestSetBit();if(r<=0)return!1;var i=e.shiftRight(r);(t=t+1>>1)>q.length&&(t=q.length);for(var n=_(),s=0;s<t;++s){n.fromInt(q[Math.floor(Math.random()*q.length)]);var o=n.modPow(i,this);if(0!=o.compareTo(E.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<r&&0!=o.compareTo(e);)if(0==(o=o.modPowInt(2,this)).compareTo(E.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0},E.prototype.clone=
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function(){var t=_();return this.copyTo(t),t},E.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},E.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},E.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},E.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},E.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var r,i=this.DB-t*this.DB%8,n=0;if(t-- >0)for(i<this.DB&&(r=this[t]>>i)!=(this.s&this.DM)>>i&&(e[n++]=r|this.s<<this.DB-i);t>=0;)i<8?(r=(this[t]&(1<<i)-1)<<8-i,r|=this[--t]>>(i+=this.DB-8)):(r=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(e[n++]=r);return e},E.prototype.equals=function(t){return 0==this.compareTo(t)},E.prototype.min=function(t){return this.compareTo(t)<0?this:t},E.prototype.max=function(t){return this.compareTo(t)>0?this:t},E.prototype.and=function(t){var e=_();return this.bitwiseTo(t,N,e),e},E.prototype.or=function(t){var e=_();return this.bitwiseTo(t,H,e),e},E.prototype.xor=function(t){var e=_();return this.bitwiseTo(t,j,e),e},E.prototype.andNot=function(t){var e=_();return this.bitwiseTo(t,U,e),e},E.prototype.not=function(){for(var t=_(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},E.prototype.shiftLeft=function(t){var e=_();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},E.prototype.shiftRight=function(t){var e=_();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},E.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+O(this[t]);return this.s<0?this.t*this.DB:-1},E.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=M(this[r]^e);return t},E.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},E.prototype.setBit=function(t){return this.changeBit(t,H)},E.prototype.clearBit=function(t){return this.changeBit(t,U)},E.prototype.flipBit=function(t){return this.changeBit(t,j)},E.prototype.add=function(t){var e=_();return this.addTo(t,e),e},E.prototype.subtract=function(t){var e=_();return this.subTo(t,e),e},E.prototype.multiply=function(t){var e=_();return this.multiplyTo(t,e),e},E.prototype.divide=function(t){var e=_();return this.divRemTo(t,e,null),e},E.prototype.remainder=function(t){var e=_();return this.divRemTo(t,null,e),e},E.prototype.divideAndRemainder=function(t){var e=_(),r=_();return this.divRemTo(t,e,r),new Array(e,r)},E.prototype.modPow=function(t,e){var r,i,n=t.bitLength(),s=D(1);if(n<=0)return s;r=n<18?1:n<48?3:n<144?4:n<768?5:6,i=n<8?new k(e):e.isEven()?new L(e):new B(e);var o=new Array,a=3,h=r-1,u=(1<<r)-1;if(o[1]=i.convert(this),r>1){var c=_();for(i.sqrTo(o[1],c);a<=u;)o[a]=_(),i.mulTo(c,o[a-2],o[a]),a+=2}var l,d,g=t.t-1,p=!0,f=_();for(n=I(t[g])-1;g>=0;){for(n>=h?l=t[g]>>n-h&u:(l=(t[g]&(1<<n+1)-1)<<h-n,g>0&&(l|=t[g-1]>>this.DB+n-h)),a=r;0==(1&l);)l>>=1,--a;if((n-=a)<0&&(n+=this.DB,--g),p)o[l].copyTo(s),p=!1;else{for(;a>1;)i.sqrTo(s,f),i.sqrTo(f,s),a-=2;a>0?i.sqrTo(s,f):(d=s,s=f,f=d),i.mulTo(f,o[l],s)}for(;g>=0&&0==(t[g]&1<<n);)i.sqrTo(s,f),d=s,s=f,f=d,--n<0&&(n=this.DB-1,--g)}return i.revert(s)},E.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return E.ZERO;for(var r=t.clone(),i=this.clone(),n=D(1),s=D(0),o=D(0),a=D(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(n.isEven()&&s.isEven()||(n.addTo(this,n),s.subTo(t,s)),n.rShiftTo(1,n)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);r.compareTo(i)>=0?(r.subTo(i,r),e&&n.subTo(o,n),s.subTo(a,s)):(i.subTo(r,i),e&&o.subTo(n,o),a.subTo(s,a))}return 0!=i.compareTo(E.ONE)?E.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a},E.prototype.pow=function(t){return this.exp(t,new V)},E.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var n=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(n<s&&(s=n),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r},E.prototype.isProbablePrime=function(t){var e,r=this.abs();if(1==r.t&&r[0]<=q[q.length-1]){for(e=0;e<q.length;++e)if(r[0]==q[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<q.length;){for(var i=q[e],n=e+1;n<q.length&&i<W;)i*=q[n++];for(i=r.modInt(i);e<n;)if(i%q[e++]==0)return!1}return r.millerRabin(t)},E.prototype.square=function(){var t=_();return this.squareTo(t),t},J.prototype.init=function(t){var e,r,i;for(e=0;e<256;++e)this.S[e]=e;for(r=0,e=0;e<256;++e)r=r+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[r],this.S[r]=i;this.i=0,this.j=0},J.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var Y,z,G,$=256;
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function X(){var t;t=(new Date).getTime(),z[G++]^=255&t,z[G++]^=t>>8&255,z[G++]^=t>>16&255,z[G++]^=t>>24&255,G>=$&&(G-=$)}if(null==z){var Z;if(z=new Array,G=0,void 0!==i&&(void 0!==i.crypto||void 0!==i.msCrypto)){var Q=i.crypto||i.msCrypto;if(Q.getRandomValues){var tt=new Uint8Array(32);for(Q.getRandomValues(tt),Z=0;Z<32;++Z)z[G++]=tt[Z]}else if("Netscape"==r.appName&&r.appVersion<"5"){var et=i.crypto.random(32);for(Z=0;Z<et.length;++Z)z[G++]=255&et.charCodeAt(Z)}}for(;G<$;)Z=Math.floor(65536*Math.random()),z[G++]=Z>>>8,z[G++]=255&Z;G=0,X()}function rt(){if(null==Y){for(X(),(Y=new J).init(z),G=0;G<z.length;++G)z[G]=0;G=0}return Y.next()}function it(){}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function nt(t,e){return new E(t,e)}function st(t,e,r){for(var i="",n=0;i.length<e;)i+=r(String.fromCharCode.apply(String,t.concat([(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n]))),n+=1;return i}function ot(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function at(t,e){this.x=e,this.q=t}function ht(t,e,r,i){this.curve=t,this.x=e,this.y=r,this.z=null==i?E.ONE:i,this.zinv=null}function ut(t,e,r){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(r),this.infinity=new ht(this,null,null)}it.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=rt()},ot.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},ot.prototype.setPublic=function(t,e){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=e;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA public key";this.n=nt(t,16),this.e=parseInt(e,16)}},ot.prototype.encrypt=function(t){var e=function(t,e){if(e<t.length+11)throw"Message too long for RSA";for(var r=new Array,i=t.length-1;i>=0&&e>0;){var n=t.charCodeAt(i--);n<128?r[--e]=n:n>127&&n<2048?(r[--e]=63&n|128,r[--e]=n>>6|192):(r[--e]=63&n|128,r[--e]=n>>6&63|128,r[--e]=n>>12|224)}r[--e]=0;for(var s=new it,o=new Array;e>2;){for(o[0]=0;0==o[0];)s.nextBytes(o);r[--e]=o[0]}return r[--e]=2,r[--e]=0,new E(r)}(t,this.n.bitLength()+7>>3);if(null==e)return null;var r=this.doPublic(e);if(null==r)return null;var i=r.toString(16);return 0==(1&i.length)?i:"0"+i},ot.prototype.encryptOAEP=function(t,e,r){var i=function(t,e,r,i){var n=lt.crypto.MessageDigest,s=lt.crypto.Util,o=null;if(r||(r="sha1"),"string"==typeof r&&(o=n.getCanonicalAlgName(r),i=n.getHashLength(o),r=function(t){return xt(s.hashHex(At(t),o))}),t.length+2*i+2>e)throw"Message too long for RSA";var a,h="";for(a=0;a<e-t.length-2*i-2;a+=1)h+="\0";var u=r("")+h+""+t,c=new Array(i);(new it).nextBytes(c);var l=st(c,u.length,r),d=[];for(a=0;a<u.length;a+=1)d[a]=u.charCodeAt(a)^l.charCodeAt(a);var g=st(d,c.length,r),p=[0];for(a=0;a<c.length;a+=1)p[a+1]=c[a]^g.charCodeAt(a);return new E(p.concat(d))}(t,this.n.bitLength()+7>>3,e,r);if(null==i)return null;var n=this.doPublic(i);if(null==n)return null;var s=n.toString(16);return 0==(1&s.length)?s:"0"+s},ot.prototype.type="RSA",at.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},at.prototype.toBigInteger=function(){return this.x},at.prototype.negate=function(){return new at(this.q,this.x.negate().mod(this.q))},at.prototype.add=function(t){return new at(this.q,this.x.add(t.toBigInteger()).mod(this.q))},at.prototype.subtract=function(t){return new at(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},at.prototype.multiply=function(t){return new at(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},at.prototype.square=function(){return new at(this.q,this.x.square().mod(this.q))},at.prototype.divide=function(t){return new at(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},ht.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ht.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},ht.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(E.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(E.ZERO))},ht.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(E.ZERO)&&!this.y.toBigInteger().equals(E.ZERO)},ht.prototype.negate=function(){return new ht(this.curve,this.x,this.y.negate(),this.z)},ht.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),r=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(E.ZERO.equals(r))return E.ZERO.equals(e)?this.twice():this.curve.getInfinity();var i=new E("3"),n=this.x.toBigInteger(),s=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),r.square()),a=o.multiply(r),h=n.multiply(o),u=e.square().multiply(this.z),c=u.subtract(h.shiftLeft(1)).multiply(t.z).subtract(a).multiply(r).mod(this.curve.q),l=h.multiply(i).multiply(e).subtract(s.multiply(a)).subtract(u.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),d=a.multiply(this.z).multiply(t.z).mod(this.curve.q);return new ht(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(l),d)},ht.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new E("3"),e=this.x.toBigInteger(),r=this.y.toBigInteger(),i=r.multiply(this.z),n=i.multiply(r).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t);E.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s)));var a=(o=o.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(n)).shiftLeft(1).multiply(i).mod(this.curve.q),h=o.multiply(t).multiply(e).subtract(n.shiftLeft(1)).shiftLeft(2).multiply(n).subtract(o.square().multiply(o)).mod(this.curve.q),u=i.square().multiply(i).shiftLeft(3).mod(this.curve.q);return new ht(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(h),u)},ht.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,r=t,i=r.multiply(new E("3")),n=this.negate(),s=this;for(e=i.bitLength()-2;e>0;--e){s=s.twice();var o=i.testBit(e);o!=r.testBit(e)&&(s=s.add(o?this:n))}return s},ht.prototype.multiplyTwo=function(t,e,r){var i;i=t.bitLength()>r.bitLength()?t.bitLength()-1:r.bitLength()-1;for(var n=this.curve.getInfinity(),s=this.add(e);i>=0;)n=n.twice(),t.testBit(i)?n=r.testBit(i)?n.add(s):n.add(this):r.testBit(i)&&(n=n.add(e)),--i;return n},ut.prototype.getQ=function(){return this.q},ut.prototype.getA=function(){return this.a},ut.prototype.getB=function(){return this.b},ut.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},ut.prototype.getInfinity=function(){return this.infinity},ut.prototype.fromBigInteger=function(t){return new at(this.q,t)},ut.prototype.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,r=t.substr(2,e),i=t.substr(e+2,e);return new ht(this,this.fromBigInteger(new E(r,16)),this.fromBigInteger(new E(i,16)));default:return null}};
/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
 */
var ct=function(){var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),e=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),r={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function i(t,e,i){return e?r[e]:String.fromCharCode(parseInt(i,16))}var n=new String(""),s=(Object,Array,Object.hasOwnProperty);return function(r,o){var a,h,u=r.match(t),c=u[0],l=!1;"{"===c?a={}:"["===c?a=[]:(a=[],l=!0);for(var d=[a],g=1-l,p=u.length;g<p;++g){var f;switch((c=u[g]).charCodeAt(0)){default:(f=d[0])[h||f.length]=+c,h=void 0;break;case 34:if(-1!==(c=c.substring(1,c.length-1)).indexOf("\\")&&(c=c.replace(e,i)),f=d[0],!h){if(!(f instanceof Array)){h=c||n;break}h=f.length}f[h]=c,h=void 0;break;case 91:f=d[0],d.unshift(f[h||f.length]=[]),h=void 0;break;case 93:d.shift();break;case 102:(f=d[0])[h||f.length]=!1,h=void 0;break;case 110:(f=d[0])[h||f.length]=null,h=void 0;break;case 116:(f=d[0])[h||f.length]=!0,h=void 0;break;case 123:f=d[0],d.unshift(f[h||f.length]={}),h=void 0;break;case 125:d.shift()}}if(l){if(1!==d.length)throw new Error;a=a[0]}else if(d.length)throw new Error;if(o){var v=function(t,e){var r=t[e];if(r&&"object"==typeof r){var i=null;for(var n in r)if(s.call(r,n)&&r!==t){var a=v(r,n);void 0!==a?r[n]=a:(i||(i=[]),i.push(n))}if(i)for(var h=i.length;--h>=0;)delete r[i[h]]}return o.call(t,e,r)};a=v({"":a},"")}return a}}();void 0!==lt&&lt||(lt={}),void 0!==lt.asn1&&lt.asn1||(lt.asn1={}),lt.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var r=e.substr(1).length;r%2==1?r+=1:e.match(/^[0-7]/)||(r+=2);for(var i="",n=0;n<r;n++)i+="f";e=new E(i,16).xor(t).add(E.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return Tt(t,e)},this.newObject=function(t){var e=lt.asn1,r=e.DERBoolean,i=e.DERInteger,n=e.DERBitString,s=e.DEROctetString,o=e.DERNull,a=e.DERObjectIdentifier,h=e.DEREnumerated,u=e.DERUTF8String,c=e.DERNumericString,l=e.DERPrintableString,d=e.DERTeletexString,g=e.DERIA5String,p=e.DERUTCTime,f=e.DERGeneralizedTime,v=e.DERSequence,y=e.DERSet,m=e.DERTaggedObject,S=e.ASN1Util.newObject,F=Object.keys(t);if(1!=F.length)throw"key of param shall be only one.";var w=F[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+w+":"))throw"undefined key: "+w;if("bool"==w)return new r(t[w]);if("int"==w)return new i(t[w]);if("bitstr"==w)return new n(t[w]);if("octstr"==w)return new s(t[w]);if("null"==w)return new o(t[w]);if("oid"==w)return new a(t[w]);if("enum"==w)return new h(t[w]);if("utf8str"==w)return new u(t[w]);if("numstr"==w)return new c(t[w]);if("prnstr"==w)return new l(t[w]);if("telstr"==w)return new d(t[w]);if("ia5str"==w)return new g(t[w]);if("utctime"==w)return new p(t[w]);if("gentime"==w)return new f(t[w]);if("seq"==w){for(var b=t[w],E=[],_=0;_<b.length;_++){var x=S(b[_]);E.push(x)}return new v({array:E})}if("set"==w){for(b=t[w],E=[],_=0;_<b.length;_++){x=S(b[_]);E.push(x)}return new y({array:E})}if("tag"==w){var A=t[w];if("[object Array]"===Object.prototype.toString.call(A)&&3==A.length){var P=S(A[2]);return new m({tag:A[0],explicit:A[1],obj:P})}var C={};if(void 0!==A.explicit&&(C.explicit=A.explicit),void 0!==A.tag&&(C.tag=A.tag),void 0===A.obj)throw"obj shall be specified for 'tag'.";return C.obj=S(A.obj),new m(C)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},lt.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",r=parseInt(t.substr(0,2),16),i=(e=Math.floor(r/40)+"."+r%40,""),n=2;n<t.length;n+=2){var s=("00000000"+parseInt(t.substr(n,2),16).toString(2)).slice(-8);if(i+=s.substr(1,7),"0"==s.substr(0,1))e=e+"."+new E(i,2).toString(10),i=""}return e},lt.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},r=function(t){var r="",i=new E(t,10).toString(2),n=7-i.length%7;7==n&&(n=0);for(var s="",o=0;o<n;o++)s+="0";i=s+i;for(o=0;o<i.length-1;o+=7){var a=i.substr(o,7);o!=i.length-7&&(a="1"+a),r+=e(parseInt(a,2))}return r};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",n=t.split("."),s=40*parseInt(n[0])+parseInt(n[1]);i+=e(s),n.splice(0,2);for(var o=0;o<n.length;o++)i+=r(n[o]);return i},lt.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var r=e.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+r).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},lt.asn1.DERAbstractString=function(t){lt.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=Et(this.s).toLowerCase()},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},n.lang.extend(lt.asn1.DERAbstractString,lt.asn1.ASN1Object),lt.asn1.DERAbstractTime=function(t){lt.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,r){var i=this.zeroPadding,n=this.localDateToUTC(t),s=String(n.getFullYear());"utc"==e&&(s=s.substr(2,2));var o=s+i(String(n.getMonth()+1),2)+i(String(n.getDate()),2)+i(String(n.getHours()),2)+i(String(n.getMinutes()),2)+i(String(n.getSeconds()),2);if(!0===r){var a=n.getMilliseconds();if(0!=a){var h=i(String(a),3);o=o+"."+(h=h.replace(/[0]+$/,""))}}return o+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=mt(t)},this.setByDateValue=function(t,e,r,i,n,s){var o=new Date(Date.UTC(t,e-1,r,i,n,s,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},n.lang.extend(lt.asn1.DERAbstractTime,lt.asn1.ASN1Object),lt.asn1.DERAbstractStructured=function(t){lt.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},n.lang.extend(lt.asn1.DERAbstractStructured,lt.asn1.ASN1Object),lt.asn1.DERBoolean=function(){lt.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},n.lang.extend(lt.asn1.DERBoolean,lt.asn1.ASN1Object),lt.asn1.DERInteger=function(t){lt.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=lt.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new E(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},n.lang.extend(lt.asn1.DERInteger,lt.asn1.ASN1Object),lt.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=lt.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}lt.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var r="0"+t;this.hTLV=null,this.isModified=!0,this.hV=r+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var r=0;r<=e;r++)t+="0";var i="";for(r=0;r<t.length-1;r+=8){var n=t.substr(r,8),s=parseInt(n,2).toString(16);1==s.length&&(s="0"+s),i+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+i},this.setByBooleanArray=function(t){for(var e="",r=0;r<t.length;r++)1==t[r]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),r=0;r<t;r++)e[r]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},n.lang.extend(lt.asn1.DERBitString,lt.asn1.ASN1Object),lt.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=lt.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}lt.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},n.lang.extend(lt.asn1.DEROctetString,lt.asn1.DERAbstractString),lt.asn1.DERNull=function(){lt.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},n.lang.extend(lt.asn1.DERNull,lt.asn1.ASN1Object),lt.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},r=function(t){var r="",i=new E(t,10).toString(2),n=7-i.length%7;7==n&&(n=0);for(var s="",o=0;o<n;o++)s+="0";i=s+i;for(o=0;o<i.length-1;o+=7){var a=i.substr(o,7);o!=i.length-7&&(a="1"+a),r+=e(parseInt(a,2))}return r};lt.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",n=t.split("."),s=40*parseInt(n[0])+parseInt(n[1]);i+=e(s),n.splice(0,2);for(var o=0;o<n.length;o++)i+=r(n[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=i},this.setValueName=function(t){var e=lt.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},n.lang.extend(lt.asn1.DERObjectIdentifier,lt.asn1.ASN1Object),lt.asn1.DEREnumerated=function(t){lt.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=lt.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new E(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},n.lang.extend(lt.asn1.DEREnumerated,lt.asn1.ASN1Object),lt.asn1.DERUTF8String=function(t){lt.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},n.lang.extend(lt.asn1.DERUTF8String,lt.asn1.DERAbstractString),lt.asn1.DERNumericString=function(t){lt.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},n.lang.extend(lt.asn1.DERNumericString,lt.asn1.DERAbstractString),lt.asn1.DERPrintableString=function(t){lt.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},n.lang.extend(lt.asn1.DERPrintableString,lt.asn1.DERAbstractString),lt.asn1.DERTeletexString=function(t){lt.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},n.lang.extend(lt.asn1.DERTeletexString,lt.asn1.DERAbstractString),lt.asn1.DERIA5String=function(t){lt.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},n.lang.extend(lt.asn1.DERIA5String,lt.asn1.DERAbstractString),lt.asn1.DERUTCTime=function(t){lt.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=mt(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=mt(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},n.lang.extend(lt.asn1.DERUTCTime,lt.asn1.DERAbstractTime),lt.asn1.DERGeneralizedTime=function(t){lt.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=mt(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=mt(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},n.lang.extend(lt.asn1.DERGeneralizedTime,lt.asn1.DERAbstractTime),lt.asn1.DERSequence=function(t){lt.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){t+=this.asn1Array[e].getEncodedHex()}return this.hV=t,this.hV}},n.lang.extend(lt.asn1.DERSequence,lt.asn1.DERAbstractStructured),lt.asn1.DERSet=function(t){lt.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var r=this.asn1Array[e];t.push(r.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},n.lang.extend(lt.asn1.DERSet,lt.asn1.DERAbstractStructured),lt.asn1.DERTaggedObject=function(t){lt.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,r){this.hT=e,this.isExplicit=t,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},n.lang.extend(lt.asn1.DERTaggedObject,lt.asn1.ASN1Object);var lt,dt,gt,pt=new function(){};function ft(t){for(var e=new Array,r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function vt(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}function yt(t){for(var e="",r=0;r<t.length;r++){var i=t[r].toString(16);1==i.length&&(i="0"+i),e+=i}return e}function mt(t){return yt(ft(t))}function St(t){return t=(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function Ft(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function wt(t){return t.length%2==1&&(t="0"+t),St(F(t))}function bt(t){return w(Ft(t))}function Et(t){return Bt(Ot(t))}function _t(t){return decodeURIComponent(Nt(t))}function xt(t){for(var e="",r=0;r<t.length-1;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e}function At(t){for(var e="",r=0;r<t.length;r++)e+=("0"+t.charCodeAt(r).toString(16)).slice(-2);return e}function Pt(t){return F(t)}function Ct(t){var e=Pt(t).replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,"")}function Rt(t){return w(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}function Tt(t,e){return"-----BEGIN "+e+"-----\r\n"+Ct(t)+"\r\n-----END "+e+"-----\r\n"}function Dt(t,e){if(-1==t.indexOf("-----BEGIN "))throw"can't find PEM header: "+e;return Rt(t=void 0!==e?(t=t.replace("-----BEGIN "+e+"-----","")).replace("-----END "+e+"-----",""):(t=t.replace(/-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----/,""))}function It(t){var e,r,i,n,s,o,a,h,u,c,l;if(l=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return h=l[1],e=parseInt(h),2===h.length&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),r=parseInt(l[2])-1,i=parseInt(l[3]),n=parseInt(l[4]),s=parseInt(l[5]),o=parseInt(l[6]),a=0,""!==(u=l[7])&&(c=(u.substr(1)+"00").substr(0,3),a=parseInt(c)),Date.UTC(e,r,i,n,s,o,a);throw"unsupported zulu format: "+t}function kt(t){return~~(It(t)/1e3)}function Bt(t){return t.replace(/%/g,"")}function Nt(t){return t.replace(/(..)/g,"%$1")}function Ht(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;var r=(t=t.toLowerCase()).split(":").length-1;if(r<2)throw e;var i=":".repeat(7-r+2),n=(t=t.replace("::",i)).split(":");if(8!=n.length)throw e;for(var s=0;s<8;s++)n[s]=("0000"+n[s]).slice(-4);return n.join("")}function jt(t){if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var e=(t=t.toLowerCase()).match(/.{1,4}/g),r=0;r<8;r++)e[r]=e[r].replace(/^0+/,""),""==e[r]&&(e[r]="0");var i=(t=":"+e.join(":")+":").match(/:(0:){2,}/g);if(null===i)return t.slice(1,-1);var n="";for(r=0;r<i.length;r++)i[r].length>n.length&&(n=i[r]);return(t=t.replace(n,"::")).slice(1,-1)}function Ut(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(8!=t.length)return 32==t.length?jt(t):t;try{return parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16)}catch(t){throw e}}function Ot(t){for(var e=encodeURIComponent(t),r="",i=0;i<e.length;i++)"%"==e[i]?(r+=e.substr(i,3),i+=2):r=r+"%"+mt(e[i]);return r}function Mt(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}function Vt(t){t=(t=(t=t.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return t.split(/,/).map(function(t,e,r){var i=parseInt(t);if(i<0||255<i)throw"integer not in range 0-255";return("00"+i.toString(16)).slice(-2)}).join("")}catch(t){throw"malformed integer array string: "+t}}pt.getLblen=function(t,e){if("8"!=t.substr(e+2,1))return 1;var r=parseInt(t.substr(e+3,1));return 0==r?-1:0<r&&r<10?r+1:-2},pt.getL=function(t,e){var r=pt.getLblen(t,e);return r<1?"":t.substr(e+2,2*r)},pt.getVblen=function(t,e){var r;return""==(r=pt.getL(t,e))?-1:("8"===r.substr(0,1)?new E(r.substr(2),16):new E(r,16)).intValue()},pt.getVidx=function(t,e){var r=pt.getLblen(t,e);return r<0?r:e+2*(r+1)},pt.getV=function(t,e){var r=pt.getVidx(t,e),i=pt.getVblen(t,e);return t.substr(r,2*i)},pt.getTLV=function(t,e){return t.substr(e,2)+pt.getL(t,e)+pt.getV(t,e)},pt.getNextSiblingIdx=function(t,e){return pt.getVidx(t,e)+2*pt.getVblen(t,e)},pt.getChildIdx=function(t,e){var r=pt,i=new Array,n=r.getVidx(t,e);"03"==t.substr(e,2)?i.push(n+2):i.push(n);for(var s=r.getVblen(t,e),o=n,a=0;;){var h=r.getNextSiblingIdx(t,o);if(null==h||h-n>=2*s)break;if(a>=200)break;i.push(h),o=h,a++}return i},pt.getNthChildIdx=function(t,e,r){return pt.getChildIdx(t,e)[r]},pt.getIdxbyList=function(t,e,r,i){var n,s,o=pt;if(0==r.length){if(void 0!==i&&t.substr(e,2)!==i)throw"checking tag doesn't match: "+t.substr(e,2)+"!="+i;return e}return n=r.shift(),s=o.getChildIdx(t,e),o.getIdxbyList(t,s[n],r,i)},pt.getTLVbyList=function(t,e,r,i){var n=pt,s=n.getIdxbyList(t,e,r);if(void 0===s)throw"can't find nthList object";if(void 0!==i&&t.substr(s,2)!=i)throw"checking tag doesn't match: "+t.substr(s,2)+"!="+i;return n.getTLV(t,s)},pt.getVbyList=function(t,e,r,i,n){var s,o,a=pt;if(void 0===(s=a.getIdxbyList(t,e,r,i)))throw"can't find nthList object";return o=a.getV(t,s),!0===n&&(o=o.substr(2)),o},pt.hextooidstr=function(t){var e=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},r=[],i=t.substr(0,2),n=parseInt(i,16);r[0]=new String(Math.floor(n/40)),r[1]=new String(n%40);for(var s=t.substr(2),o=[],a=0;a<s.length/2;a++)o.push(parseInt(s.substr(2*a,2),16));var h=[],u="";for(a=0;a<o.length;a++)128&o[a]?u+=e((127&o[a]).toString(2),7):(u+=e((127&o[a]).toString(2),7),h.push(new String(parseInt(u,2))),u="");var c=r.join(".");return h.length>0&&(c=c+"."+h.join(".")),c},pt.dump=function(t,e,r,i){var n=pt,s=n.getV,o=n.dump,a=n.getChildIdx,h=t;t instanceof lt.asn1.ASN1Object&&(h=t.getEncodedHex());var u=function(t,e){return t.length<=2*e?t:t.substr(0,e)+"..(total "+t.length/2+"bytes).."+t.substr(t.length-e,e)};void 0===e&&(e={ommit_long_octet:32}),void 0===r&&(r=0),void 0===i&&(i="");var c=e.ommit_long_octet;if("01"==h.substr(r,2))return"00"==(l=s(h,r))?i+"BOOLEAN FALSE\n":i+"BOOLEAN TRUE\n";if("02"==h.substr(r,2))return i+"INTEGER "+u(l=s(h,r),c)+"\n";if("03"==h.substr(r,2))return i+"BITSTRING "+u(l=s(h,r),c)+"\n";if("04"==h.substr(r,2)){var l=s(h,r);if(n.isASN1HEX(l)){var d=i+"OCTETSTRING, encapsulates\n";return d+=o(l,e,0,i+"  ")}return i+"OCTETSTRING "+u(l,c)+"\n"}if("05"==h.substr(r,2))return i+"NULL\n";if("06"==h.substr(r,2)){var g=s(h,r),p=lt.asn1.ASN1Util.oidHexToInt(g),f=lt.asn1.x509.OID.oid2name(p),v=p.replace(/\./g," ");return""!=f?i+"ObjectIdentifier "+f+" ("+v+")\n":i+"ObjectIdentifier ("+v+")\n"}if("0c"==h.substr(r,2))return i+"UTF8String '"+_t(s(h,r))+"'\n";if("13"==h.substr(r,2))return i+"PrintableString '"+_t(s(h,r))+"'\n";if("14"==h.substr(r,2))return i+"TeletexString '"+_t(s(h,r))+"'\n";if("16"==h.substr(r,2))return i+"IA5String '"+_t(s(h,r))+"'\n";if("17"==h.substr(r,2))return i+"UTCTime "+_t(s(h,r))+"\n";if("18"==h.substr(r,2))return i+"GeneralizedTime "+_t(s(h,r))+"\n";if("30"==h.substr(r,2)){if("3000"==h.substr(r,4))return i+"SEQUENCE {}\n";d=i+"SEQUENCE\n";var y=e;if((2==(F=a(h,r)).length||3==F.length)&&"06"==h.substr(F[0],2)&&"04"==h.substr(F[F.length-1],2)){f=n.oidname(s(h,F[0]));var m=JSON.parse(JSON.stringify(e));m.x509ExtName=f,y=m}for(var S=0;S<F.length;S++)d+=o(h,y,F[S],i+"  ");return d}if("31"==h.substr(r,2)){d=i+"SET\n";var F=a(h,r);for(S=0;S<F.length;S++)d+=o(h,e,F[S],i+"  ");return d}var w=parseInt(h.substr(r,2),16);if(0!=(128&w)){var b=31&w;if(0!=(32&w)){var d=i+"["+b+"]\n";for(F=a(h,r),S=0;S<F.length;S++)d+=o(h,e,F[S],i+"  ");return d}return"68747470"==(l=s(h,r)).substr(0,8)&&(l=_t(l)),"subjectAltName"===e.x509ExtName&&2==b&&(l=_t(l)),d=i+"["+b+"] "+l+"\n"}return i+"UNKNOWN("+h.substr(r,2)+") "+s(h,r)+"\n"},pt.isASN1HEX=function(t){var e=pt;if(t.length%2==1)return!1;var r=e.getVblen(t,0),i=t.substr(0,2),n=e.getL(t,0);return t.length-i.length-n.length==2*r},pt.oidname=function(t){var e=lt.asn1;lt.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var r=e.x509.OID.oid2name(t);return""===r&&(r=t),r},void 0!==lt&&lt||(lt={}),void 0!==lt.asn1&&lt.asn1||(lt.asn1={}),void 0!==lt.asn1.x509&&lt.asn1.x509||(lt.asn1.x509={}),lt.asn1.x509.Certificate=function(t){lt.asn1.x509.Certificate.superclass.constructor.call(this);var e=lt,r=(e.crypto,e.asn1),i=r.DERSequence,n=r.DERBitString;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;var t=new lt.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg});t.init(this.prvKey),t.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=t.sign(),this.asn1Sig=new n({hex:"00"+this.hexSig});var e=new i({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.setSignatureHex=function(t){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,this.hexSig=t,this.asn1Sig=new n({hex:"00"+this.hexSig});var e=new i({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN CERTIFICATE-----\r\n"+Ct(this.getEncodedHex())+"\r\n-----END CERTIFICATE-----\r\n"},void 0!==t&&(void 0!==t.tbscertobj&&(this.asn1TBSCert=t.tbscertobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},n.lang.extend(lt.asn1.x509.Certificate,lt.asn1.ASN1Object),lt.asn1.x509.TBSCertificate=function(t){lt.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=lt.asn1,r=e.DERSequence,i=e.DERInteger,n=e.DERTaggedObject,s=e.x509,o=s.Time,a=s.X500Name,h=s.SubjectPublicKeyInfo;this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new n({obj:new i({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(t){this.asn1SerialNumber=new i(t)},this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new s.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new a(t)},this.setNotBeforeByParam=function(t){this.asn1NotBefore=new o(t)},this.setNotAfterByParam=function(t){this.asn1NotAfter=new o(t)},this.setSubjectByParam=function(t){this.asn1Subject=new a(t)},this.setSubjectPublicKey=function(t){this.asn1SubjPKey=new h(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=Kt.getKey(t);this.asn1SubjPKey=new h(e)},this.appendExtension=function(t){this.extensionsArray.push(t)},this.appendExtensionByName=function(t,e){lt.asn1.x509.Extension.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var t=new r({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(t),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var e=new r({array:this.extensionsArray}),i=new n({explicit:!0,tag:"a3",obj:e});this.asn1Array.push(i)}var s=new r({array:this.asn1Array});return this.hTLV=s.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},n.lang.extend(lt.asn1.x509.TBSCertificate,lt.asn1.ASN1Object),lt.asn1.x509.Extension=function(t){lt.asn1.x509.Extension.superclass.constructor.call(this);var e=lt.asn1,r=e.DERObjectIdentifier,i=e.DEROctetString,n=(e.DERBitString,e.DERBoolean),s=e.DERSequence;this.getEncodedHex=function(){var t=new r({oid:this.oid}),e=new i({hex:this.getExtnValueHex()}),o=new Array;return o.push(t),this.critical&&o.push(new n),o.push(e),new s({array:o}).getEncodedHex()},this.critical=!1,void 0!==t&&void 0!==t.critical&&(this.critical=t.critical)},n.lang.extend(lt.asn1.x509.Extension,lt.asn1.ASN1Object),lt.asn1.x509.Extension.appendByNameToArray=function(t,e,r){var i=t.toLowerCase(),n=lt.asn1.x509;if("basicconstraints"==i){var s=new n.BasicConstraints(e);r.push(s)}else if("keyusage"==i){s=new n.KeyUsage(e);r.push(s)}else if("crldistributionpoints"==i){s=new n.CRLDistributionPoints(e);r.push(s)}else if("extkeyusage"==i){s=new n.ExtKeyUsage(e);r.push(s)}else if("authoritykeyidentifier"==i){s=new n.AuthorityKeyIdentifier(e);r.push(s)}else if("authorityinfoaccess"==i){s=new n.AuthorityInfoAccess(e);r.push(s)}else if("subjectaltname"==i){s=new n.SubjectAltName(e);r.push(s)}else{if("issueraltname"!=i)throw"unsupported extension name: "+t;s=new n.IssuerAltName(e);r.push(s)}},lt.asn1.x509.KeyUsage=function(t){lt.asn1.x509.KeyUsage.superclass.constructor.call(this,t);var e=Yt.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==t&&(void 0!==t.bin&&(this.asn1ExtnValue=new lt.asn1.DERBitString(t)),void 0!==t.names&&void 0!==t.names.length)){for(var r=t.names,i="000000000",n=0;n<r.length;n++)for(var s=0;s<e.length;s++)r[n]===e[s]&&(i=i.substring(0,s)+"1"+i.substring(s+1,i.length));this.asn1ExtnValue=new lt.asn1.DERBitString({bin:i})}},n.lang.extend(lt.asn1.x509.KeyUsage,lt.asn1.x509.Extension),lt.asn1.x509.BasicConstraints=function(t){lt.asn1.x509.BasicConstraints.superclass.constructor.call(this,t);this.getExtnValueHex=function(){var t=new Array;this.cA&&t.push(new lt.asn1.DERBoolean),this.pathLen>-1&&t.push(new lt.asn1.DERInteger({int:this.pathLen}));var e=new lt.asn1.DERSequence({array:t});return this.asn1ExtnValue=e,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==t&&(void 0!==t.cA&&(this.cA=t.cA),void 0!==t.pathLen&&(this.pathLen=t.pathLen))},n.lang.extend(lt.asn1.x509.BasicConstraints,lt.asn1.x509.Extension),lt.asn1.x509.CRLDistributionPoints=function(t){lt.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,t);var e=lt.asn1,r=e.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(t){this.asn1ExtnValue=new e.DERSequence({array:t})},this.setByOneURI=function(t){var e=new r.GeneralNames([{uri:t}]),i=new r.DistributionPointName(e),n=new r.DistributionPoint({dpobj:i});this.setByDPArray([n])},this.oid="2.5.29.31",void 0!==t&&(void 0!==t.array?this.setByDPArray(t.array):void 0!==t.uri&&this.setByOneURI(t.uri))},n.lang.extend(lt.asn1.x509.CRLDistributionPoints,lt.asn1.x509.Extension),lt.asn1.x509.ExtKeyUsage=function(t){lt.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,t);var e=lt.asn1;this.setPurposeArray=function(t){this.asn1ExtnValue=new e.DERSequence;for(var r=0;r<t.length;r++){var i=new e.DERObjectIdentifier(t[r]);this.asn1ExtnValue.appendASN1Object(i)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==t&&void 0!==t.array&&this.setPurposeArray(t.array)},n.lang.extend(lt.asn1.x509.ExtKeyUsage,lt.asn1.x509.Extension),lt.asn1.x509.AuthorityKeyIdentifier=function(t){lt.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,t);var e=lt.asn1,r=e.DERTaggedObject;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var t=new Array;this.asn1KID&&t.push(new r({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&t.push(new r({explicit:!1,tag:"a1",obj:this.asn1CertIssuer})),this.asn1CertSN&&t.push(new r({explicit:!1,tag:"82",obj:this.asn1CertSN}));var i=new e.DERSequence({array:t});return this.asn1ExtnValue=i,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(t){this.asn1KID=new lt.asn1.DEROctetString(t)},this.setCertIssuerByParam=function(t){this.asn1CertIssuer=new lt.asn1.x509.X500Name(t)},this.setCertSNByParam=function(t){this.asn1CertSN=new lt.asn1.DERInteger(t)},this.oid="2.5.29.35",void 0!==t&&(void 0!==t.kid&&this.setKIDByParam(t.kid),void 0!==t.issuer&&this.setCertIssuerByParam(t.issuer),void 0!==t.sn&&this.setCertSNByParam(t.sn))},n.lang.extend(lt.asn1.x509.AuthorityKeyIdentifier,lt.asn1.x509.Extension),lt.asn1.x509.AuthorityInfoAccess=function(t){lt.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,t),this.setAccessDescriptionArray=function(t){for(var e=new Array,r=lt.asn1,i=r.DERSequence,n=0;n<t.length;n++){var s=new i({array:[new r.DERObjectIdentifier(t[n].accessMethod),new r.x509.GeneralName(t[n].accessLocation)]});e.push(s)}this.asn1ExtnValue=new i({array:e})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==t&&void 0!==t.array&&this.setAccessDescriptionArray(t.array)},n.lang.extend(lt.asn1.x509.AuthorityInfoAccess,lt.asn1.x509.Extension),lt.asn1.x509.SubjectAltName=function(t){lt.asn1.x509.SubjectAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new lt.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},n.lang.extend(lt.asn1.x509.SubjectAltName,lt.asn1.x509.Extension),lt.asn1.x509.IssuerAltName=function(t){lt.asn1.x509.IssuerAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new lt.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},n.lang.extend(lt.asn1.x509.IssuerAltName,lt.asn1.x509.Extension),lt.asn1.x509.CRL=function(t){lt.asn1.x509.CRL.superclass.constructor.call(this);this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new lt.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new lt.asn1.DERBitString({hex:"00"+this.hexSig});var t=new lt.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN X509 CRL-----\r\n"+Ct(this.getEncodedHex())+"\r\n-----END X509 CRL-----\r\n"},void 0!==t&&(void 0!==t.tbsobj&&(this.asn1TBSCertList=t.tbsobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},n.lang.extend(lt.asn1.x509.CRL,lt.asn1.ASN1Object),lt.asn1.x509.TBSCertList=function(t){lt.asn1.x509.TBSCertList.superclass.constructor.call(this);var e=lt.asn1,r=e.DERSequence,i=e.x509,n=i.Time;this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new i.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new i.X500Name(t)},this.setThisUpdateByParam=function(t){this.asn1ThisUpdate=new n(t)},this.setNextUpdateByParam=function(t){this.asn1NextUpdate=new n(t)},this.addRevokedCert=function(t,e){var r={};void 0!=t&&null!=t&&(r.sn=t),void 0!=e&&null!=e&&(r.time=e);var n=new i.CRLEntry(r);this.aRevokedCert.push(n)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var t=new r({array:this.aRevokedCert});this.asn1Array.push(t)}var e=new r({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},n.lang.extend(lt.asn1.x509.TBSCertList,lt.asn1.ASN1Object),lt.asn1.x509.CRLEntry=function(t){lt.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=lt.asn1;this.setCertSerial=function(t){this.sn=new e.DERInteger(t)},this.setRevocationDate=function(t){this.time=new e.x509.Time(t)},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.sn,this.time]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&(void 0!==t.time&&this.setRevocationDate(t.time),void 0!==t.sn&&this.setCertSerial(t.sn))},n.lang.extend(lt.asn1.x509.CRLEntry,lt.asn1.ASN1Object),lt.asn1.x509.X500Name=function(t){lt.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array;var e=lt.asn1,r=e.x509,i=Dt;if(this.setByString=function(t){var e=t.split("/");e.shift();for(var i=[],n=0;n<e.length;n++)if(e[n].match(/^[^=]+=.+$/))i.push(e[n]);else{var s=i.length-1;i[s]=i[s]+"/"+e[n]}for(n=0;n<i.length;n++)this.asn1Array.push(new r.RDN({str:i[n]}))},this.setByLdapString=function(t){var e=r.X500Name.ldapToOneline(t);this.setByString(e)},this.setByObject=function(t){for(var e in t)if(t.hasOwnProperty(e)){var r=new lt.asn1.x509.RDN({str:e+"="+t[e]});this.asn1Array?this.asn1Array.push(r):this.asn1Array=[r]}},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSequence({array:this.asn1Array});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t){var n;if(void 0!==t.str?this.setByString(t.str):void 0!==t.ldapstr?this.setByLdapString(t.ldapstr):"object"==typeof t&&this.setByObject(t),void 0!==t.certissuer)(n=new Yt).hex=i(t.certissuer),this.hTLV=n.getIssuerHex();if(void 0!==t.certsubject)(n=new Yt).hex=i(t.certsubject),this.hTLV=n.getSubjectHex()}},n.lang.extend(lt.asn1.x509.X500Name,lt.asn1.ASN1Object),lt.asn1.x509.X500Name.onelineToLDAP=function(t){if("/"!==t.substr(0,1))throw"malformed input";var e=(t=t.substr(1)).split("/");return e.reverse(),(e=e.map(function(t){return t.replace(/,/,"\\,")})).join(",")},lt.asn1.x509.X500Name.ldapToOneline=function(t){for(var e=t.split(","),r=!1,i=[],n=0;e.length>0;n++){var s=e.shift();if(!0===r){var o=(i.pop()+","+s).replace(/\\,/g,",");i.push(o),r=!1}else i.push(s);"\\"===s.substr(-1,1)&&(r=!0)}return(i=i.map(function(t){return t.replace("/","\\/")})).reverse(),"/"+i.join("/")},lt.asn1.x509.RDN=function(t){lt.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(t){this.asn1Array.push(new lt.asn1.x509.AttributeTypeAndValue({str:t}))},this.addByMultiValuedString=function(t){for(var e=lt.asn1.x509.RDN.parseString(t),r=0;r<e.length;r++)this.addByString(e[r])},this.getEncodedHex=function(){var t=new lt.asn1.DERSet({array:this.asn1Array});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.addByMultiValuedString(t.str)},n.lang.extend(lt.asn1.x509.RDN,lt.asn1.ASN1Object),lt.asn1.x509.RDN.parseString=function(t){for(var e=t.split(/\+/),r=!1,i=[],n=0;e.length>0;n++){var s=e.shift();if(!0===r){var o=(i.pop()+"+"+s).replace(/\\\+/g,"+");i.push(o),r=!1}else i.push(s);"\\"===s.substr(-1,1)&&(r=!0)}var a=!1,h=[];for(n=0;i.length>0;n++){s=i.shift();if(!0===a){var u=h.pop();if(s.match(/"$/)){o=(u+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");h.push(o),a=!1}else h.push(u+"+"+s)}else h.push(s);s.match(/^[^=]+="/)&&(a=!0)}return h},lt.asn1.x509.AttributeTypeAndValue=function(t){lt.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var e=lt.asn1;this.setByString=function(t){var e=t.match(/^([^=]+)=(.+)$/);if(!e)throw"malformed attrTypeAndValueStr: "+t;this.setByAttrTypeAndValueStr(e[1],e[2])},this.setByAttrTypeAndValueStr=function(t,e){this.typeObj=lt.asn1.x509.OID.atype2obj(t);var r="utf8";"C"==t&&(r="prn"),this.valueObj=this.getValueObj(r,e)},this.getValueObj=function(t,r){if("utf8"==t)return new e.DERUTF8String({str:r});if("prn"==t)return new e.DERPrintableString({str:r});if("tel"==t)return new e.DERTeletexString({str:r});if("ia5"==t)return new e.DERIA5String({str:r});throw"unsupported directory string type: type="+t+" value="+r},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.setByString(t.str)},n.lang.extend(lt.asn1.x509.AttributeTypeAndValue,lt.asn1.ASN1Object),lt.asn1.x509.SubjectPublicKeyInfo=function(t){lt.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=lt,r=e.asn1,i=r.DERInteger,n=r.DERBitString,s=r.DERObjectIdentifier,o=r.DERSequence,a=r.ASN1Util.newObject,h=r.x509.AlgorithmIdentifier,u=e.crypto;u.ECDSA,u.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new o({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var t=this.getASN1Object();return this.hTLV=t.getEncodedHex(),this.hTLV},this.setPubKey=function(t){try{if(t instanceof ot){var e=a({seq:[{int:{bigint:t.n}},{int:{int:t.e}}]}).getEncodedHex();this.asn1AlgId=new h({name:"rsaEncryption"}),this.asn1SubjPKey=new n({hex:"00"+e})}}catch(t){}try{if(t instanceof lt.crypto.ECDSA){var r=new s({name:t.curveName});this.asn1AlgId=new h({name:"ecPublicKey",asn1params:r}),this.asn1SubjPKey=new n({hex:"00"+t.pubKeyHex})}}catch(t){}try{if(t instanceof lt.crypto.DSA){r=new a({seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]});this.asn1AlgId=new h({name:"dsa",asn1params:r});var o=new i({bigint:t.y});this.asn1SubjPKey=new n({hex:"00"+o.getEncodedHex()})}}catch(t){}},void 0!==t&&this.setPubKey(t)},n.lang.extend(lt.asn1.x509.SubjectPublicKeyInfo,lt.asn1.ASN1Object),lt.asn1.x509.Time=function(t){lt.asn1.x509.Time.superclass.constructor.call(this);var e=lt.asn1,r=e.DERUTCTime,i=e.DERGeneralizedTime;this.setTimeParams=function(t){this.timeParams=t},this.getEncodedHex=function(){var t=null;return t=null!=this.timeParams?"utc"==this.type?new r(this.timeParams):new i(this.timeParams):"utc"==this.type?new r:new i,this.TLV=t.getEncodedHex(),this.TLV},this.type="utc",void 0!==t&&(void 0!==t.type?this.type=t.type:void 0!==t.str&&(t.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),t.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=t)},n.lang.extend(lt.asn1.x509.Time,lt.asn1.ASN1Object),lt.asn1.x509.AlgorithmIdentifier=function(t){lt.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var e=lt.asn1;if(this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw"algorithm not specified";null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=e.x509.OID.name2obj(this.nameAlg));var t=[this.asn1Alg];null!==this.asn1Params&&t.push(this.asn1Params);var r=new e.DERSequence({array:t});return this.hTLV=r.getEncodedHex(),this.hTLV},void 0!==t&&(void 0!==t.name&&(this.nameAlg=t.name),void 0!==t.asn1params&&(this.asn1Params=t.asn1params),void 0!==t.paramempty&&(this.paramEmpty=t.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){var r=this.nameAlg.toLowerCase();"withdsa"!==r.substr(-7,7)&&"withecdsa"!==r.substr(-9,9)&&(this.asn1Params=new e.DERNull)}},n.lang.extend(lt.asn1.x509.AlgorithmIdentifier,lt.asn1.ASN1Object),lt.asn1.x509.GeneralName=function(t){lt.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},r=lt.asn1,i=(r.DERSequence,r.DEROctetString),n=r.DERIA5String,s=r.DERTaggedObject,o=r.ASN1Object,a=r.x509.X500Name,h=Dt;this.explicit=!1,this.setByParam=function(t){var r=null;if(void 0!==t){if(void 0!==t.rfc822&&(this.type="rfc822",r=new n({str:t[this.type]})),void 0!==t.dns&&(this.type="dns",r=new n({str:t[this.type]})),void 0!==t.uri&&(this.type="uri",r=new n({str:t[this.type]})),void 0!==t.dn&&(this.type="dn",this.explicit=!0,r=new a({str:t.dn})),void 0!==t.ldapdn&&(this.type="dn",this.explicit=!0,r=new a({ldapstr:t.ldapdn})),void 0!==t.certissuer){this.type="dn",this.explicit=!0;var u=null;if((l=t.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=l.indexOf("-----BEGIN ")&&(u=h(l)),null==u)throw"certissuer param not cert";(d=new Yt).hex=u;var c=d.getIssuerHex();(r=new o).hTLV=c}if(void 0!==t.certsubj){this.type="dn",this.explicit=!0;var l,d;u=null;if((l=t.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=l.indexOf("-----BEGIN ")&&(u=h(l)),null==u)throw"certsubj param not cert";(d=new Yt).hex=u;c=d.getSubjectHex();(r=new o).hTLV=c}if(void 0!==t.ip){this.type="ip",this.explicit=!1;var g,p=t.ip,f="malformed IP address";if(p.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(g=Vt("["+p.split(".").join(",")+"]")).length)throw f}else if(p.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))g=Ht(p);else{if(!p.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw f;g=p}r=new i({hex:g})}if(null==this.type)throw"unsupported type in params="+t;this.asn1Obj=new s({explicit:this.explicit,tag:e[this.type],obj:r})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==t&&this.setByParam(t)},n.lang.extend(lt.asn1.x509.GeneralName,lt.asn1.ASN1Object),lt.asn1.x509.GeneralNames=function(t){lt.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=lt.asn1;this.setByParamArray=function(t){for(var r=0;r<t.length;r++){var i=new e.x509.GeneralName(t[r]);this.asn1Array.push(i)}},this.getEncodedHex=function(){return new e.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==t&&this.setByParamArray(t)},n.lang.extend(lt.asn1.x509.GeneralNames,lt.asn1.ASN1Object),lt.asn1.x509.DistributionPointName=function(t){lt.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=lt.asn1,r=e.DERTaggedObject;if(this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new r({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==t){if(!e.x509.GeneralNames.prototype.isPrototypeOf(t))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=t}},n.lang.extend(lt.asn1.x509.DistributionPointName,lt.asn1.ASN1Object),lt.asn1.x509.DistributionPoint=function(t){lt.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=lt.asn1;this.getEncodedHex=function(){var t=new e.DERSequence;if(null!=this.asn1DP){var r=new e.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});t.appendASN1Object(r)}return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.dpobj&&(this.asn1DP=t.dpobj)},n.lang.extend(lt.asn1.x509.DistributionPoint,lt.asn1.ASN1Object),lt.asn1.x509.OID=new function(t){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var e=this.name2oidList[t],r=new lt.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=r,r},this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.atype2oidList[t])throw"AttributeType name undefined: "+t;var e=this.atype2oidList[t],r=new lt.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=r,r}},lt.asn1.x509.OID.oid2name=function(t){var e=lt.asn1.x509.OID.name2oidList;for(var r in e)if(e[r]==t)return r;return""},lt.asn1.x509.OID.oid2atype=function(t){var e=lt.asn1.x509.OID.atype2oidList;for(var r in e)if(e[r]==t)return r;return t},lt.asn1.x509.OID.name2oid=function(t){var e=lt.asn1.x509.OID.name2oidList;return void 0===e[t]?"":e[t]},lt.asn1.x509.X509Util={},lt.asn1.x509.X509Util.newCertPEM=function(t){var e=lt.asn1.x509,r=e.TBSCertificate,i=e.Certificate,n=new r;if(void 0===t.serial)throw"serial number undefined.";if(n.setSerialNumberByParam(t.serial),"string"!=typeof t.sigalg.name)throw"unproper signature algorithm name";if(n.setSignatureAlgByParam(t.sigalg),void 0===t.issuer)throw"issuer name undefined.";if(n.setIssuerByParam(t.issuer),void 0===t.notbefore)throw"notbefore undefined.";if(n.setNotBeforeByParam(t.notbefore),void 0===t.notafter)throw"notafter undefined.";if(n.setNotAfterByParam(t.notafter),void 0===t.subject)throw"subject name undefined.";if(n.setSubjectByParam(t.subject),void 0===t.sbjpubkey)throw"subject public key undefined.";if(n.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var s=0;s<t.ext.length;s++)for(key in t.ext[s])n.appendExtensionByName(key,t.ext[s][key]);if(void 0===t.cakey&&void 0===t.sighex)throw"param cakey and sighex undefined.";var o=null;return t.cakey&&(o=new i({tbscertobj:n,prvkeyobj:!0===t.cakey.isPrivate?t.cakey:Kt.getKey.apply(null,t.cakey)})).sign(),t.sighex&&(o=new i({tbscertobj:n})).setSignatureHex(t.sighex),o.getPEMString()},void 0!==lt&&lt||(lt={}),void 0!==lt.lang&&lt.lang||(lt.lang={}),lt.lang.String=function(){},"function"==typeof t?(dt=function(e){return St(new t(e,"utf8").toString("base64"))},gt=function(e){return new t(Ft(e),"base64").toString("utf8")}):(dt=function(t){return wt(Bt(Ot(t)))},gt=function(t){return decodeURIComponent(Nt(bt(t)))}),lt.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},lt.lang.String.isHex=function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))},lt.lang.String.isBase64=function(t){return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},lt.lang.String.isBase64URL=function(t){return!t.match(/[+/=]/)&&(t=Ft(t),lt.lang.String.isBase64(t))},lt.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)};void 0!==lt&&lt||(lt={}),void 0!==lt.crypto&&lt.crypto||(lt.crypto={}),lt.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:v.algo.MD5,sha1:v.algo.SHA1,sha224:v.algo.SHA224,sha256:v.algo.SHA256,sha384:v.algo.SHA384,sha512:v.algo.SHA512,ripemd160:v.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,r){var i=this.getDigestInfoHex(t,e),n=r/4;if(i.length+22>n)throw"key is too short for SigAlg: keylen="+r+","+e;for(var s="0001",o="00"+i,a="",h=n-s.length-o.length,u=0;u<h;u+=2)a+="ff";return s+a+o},this.hashString=function(t,e){return new lt.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new lt.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new lt.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new lt.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new lt.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new lt.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new lt.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)}},lt.crypto.Util.md5=function(t){return new lt.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},lt.crypto.Util.ripemd160=function(t){return new lt.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},lt.crypto.Util.SECURERANDOMGEN=new it,lt.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return lt.crypto.Util.SECURERANDOMGEN.nextBytes(e),yt(e)},lt.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new E(lt.crypto.Util.getRandomHexOfNbytes(t),16)},lt.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,r=new Array((t-e)/8+1);return lt.crypto.Util.SECURERANDOMGEN.nextBytes(r),r[0]=(255<<e&255^255)&r[0],yt(r)},lt.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new E(lt.crypto.Util.getRandomHexOfNbits(t),16)},lt.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var r=lt.crypto.Util.getRandomBigIntegerOfNbits(e);if(-1!=t.compareTo(r))return r}},lt.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var r=t.compareTo(e);if(1==r)throw"biMin is greater than biMax";if(0==r)return t;var i=e.subtract(t);return lt.crypto.Util.getRandomBigIntegerZeroToMax(i).add(t)},lt.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(null!==(t=lt.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=lt.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=lt.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=v.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(v.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=lt.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},lt.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},lt.crypto.MessageDigest.getHashLength=function(t){var e=lt.crypto.MessageDigest,r=e.getCanonicalAlgName(t);if(void 0===e.HASHLENGTH[r])throw"not supported algorithm: "+t;return e.HASHLENGTH[r]},lt.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},lt.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=lt.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var r=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)&&"cryptojs"==e){try{var i=lt.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=v.algo.HMAC.create(i,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=v.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(v.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=At(t)),void(this.pass=v.enc.Hex.parse(e))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;e=null;if(void 0!==t.hex){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=Et(t.utf8)),void 0!==t.rstr&&(e=At(t.rstr)),void 0!==t.b64&&(e=w(t.b64)),void 0!==t.b64u&&(e=bt(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=v.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=lt.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},lt.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var r="",i=e/4-t.length,n=0;n<i;n++)r+="0";return r+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new lt.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var r=null;try{r=void 0===e?Kt.getKey(t):Kt.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===r.isPrivate)this.prvKey=r,this.state="SIGN";else{if(!0!==r.isPublic)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var t=new lt.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof ot&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof ot&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof lt.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof lt.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new lt.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,t,this.ecpubhex);if(this.pubKey instanceof ot&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof ot&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==lt.crypto.ECDSA&&this.pubKey instanceof lt.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==lt.crypto.DSA&&this.pubKey instanceof lt.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=lt.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{e=Kt.getKey(t.prvkeypem);this.init(e)}catch(t){throw"fatal error to load pem private key: "+t}}},lt.crypto.Cipher=function(t){},lt.crypto.Cipher.encrypt=function(t,e,r){if(e instanceof ot&&e.isPublic){var i=lt.crypto.Cipher.getAlgByKeyAndName(e,r);if("RSA"===i)return e.encrypt(t);if("RSAOAEP"===i)return e.encryptOAEP(t,"sha1");var n=i.match(/^RSAOAEP(\d+)$/);if(null!==n)return e.encryptOAEP(t,"sha"+n[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.encrypt: unsupported key or algorithm"},lt.crypto.Cipher.decrypt=function(t,e,r){if(e instanceof ot&&e.isPrivate){var i=lt.crypto.Cipher.getAlgByKeyAndName(e,r);if("RSA"===i)return e.decrypt(t);if("RSAOAEP"===i)return e.decryptOAEP(t,"sha1");var n=i.match(/^RSAOAEP(\d+)$/);if(null!==n)return e.decryptOAEP(t,"sha"+n[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.decrypt: unsupported key or algorithm"},lt.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof ot){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e))return e;if(null===e||void 0===e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},lt.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==lt&&lt||(lt={}),void 0!==lt.crypto&&lt.crypto||(lt.crypto={}),lt.crypto.ECDSA=function(t){var e=new it;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(t){return new E(t.bitLength(),e).mod(t.subtract(E.ONE)).add(E.ONE)},this.setNamedCurve=function(t){this.ecparams=lt.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var r={};return r.x=t.substr(2,e),r.y=t.substr(2+e),r},this.getShortNISTPCurveName=function(){var t=this.curveName;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),r=this.ecparams.G.multiply(e),i=r.getX().toBigInteger(),n=r.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+i.toString(16)).slice(-s)+("0000000000"+n.toString(16)).slice(-s);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var r=new E(e,16),i=this.ecparams.n,n=new E(t,16);do{var s=this.getBigRandom(i),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(o.compareTo(E.ZERO)<=0);var a=s.modInverse(i).multiply(n.add(r.multiply(o))).mod(i);return lt.crypto.ECDSA.biRSSigToASN1Sig(o,a)},this.sign=function(t,e){var r=e,i=this.ecparams.n,n=E.fromByteArrayUnsigned(t);do{var s=this.getBigRandom(i),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(o.compareTo(E.ZERO)<=0);var a=s.modInverse(i).multiply(n.add(r.multiply(o))).mod(i);return this.serializeSig(o,a)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,r){var i,n,s,o=lt.crypto.ECDSA.parseSigHex(e);i=o.r,n=o.s,s=ht.decodeFromHex(this.ecparams.curve,r);var a=new E(t,16);return this.verifyRaw(a,i,n,s)},this.verify=function(t,e,r){var i,n,s;if(Bitcoin.Util.isArray(e)){var o=this.parseSig(e);i=o.r,n=o.s}else{if("object"!=typeof e||!e.r||!e.s)throw"Invalid value for signature";i=e.r,n=e.s}if(r instanceof ht)s=r;else{if(!Bitcoin.Util.isArray(r))throw"Invalid format for pubkey value, must be byte array or ECPointFp";s=ht.decodeFrom(this.ecparams.curve,r)}var a=E.fromByteArrayUnsigned(t);return this.verifyRaw(a,i,n,s)},this.verifyRaw=function(t,e,r,i){var n=this.ecparams.n,s=this.ecparams.G;if(e.compareTo(E.ONE)<0||e.compareTo(n)>=0)return!1;if(r.compareTo(E.ONE)<0||r.compareTo(n)>=0)return!1;var o=r.modInverse(n),a=t.multiply(o).mod(n),h=e.multiply(o).mod(n);return s.multiply(a).add(i.multiply(h)).getX().toBigInteger().mod(n).equals(e)},this.serializeSig=function(t,e){var r=t.toByteArraySigned(),i=e.toByteArraySigned(),n=[];return n.push(2),n.push(r.length),(n=n.concat(r)).push(2),n.push(i.length),(n=n.concat(i)).unshift(n.length),n.unshift(48),n},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:E.fromByteArrayUnsigned(r),s:E.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var r=this.ecparams.n;return{r:E.fromByteArrayUnsigned(t.slice(1,33)).mod(r),s:E.fromByteArrayUnsigned(t.slice(33,65)).mod(r),i:e}},this.readPKCS5PrvKeyHex=function(t){var e,r,i,n=pt,s=lt.crypto.ECDSA.getName,o=n.getVbyList;if(!1===n.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[2,0],"06"),r=o(t,0,[1],"04");try{i=o(t,0,[3,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){var e,r,i,n=pt,s=lt.crypto.ECDSA.getName,o=n.getVbyList;if(!1===n.isASN1HEX(t))throw"not ASN.1 hex string";try{o(t,0,[1,0],"06"),e=o(t,0,[1,1],"06"),r=o(t,0,[2,0,1],"04");try{i=o(t,0,[2,0,2,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){var e,r,i=pt,n=lt.crypto.ECDSA.getName,s=i.getVbyList;if(!1===i.isASN1HEX(t))throw"not ASN.1 hex string";try{s(t,0,[0,0],"06"),e=s(t,0,[0,1],"06"),r=s(t,0,[1],"03").substr(2)}catch(t){throw"malformed PKCS#8 ECC public key"}if(this.curveName=n(e),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(r)},this.readCertPubKeyHex=function(t,e){5!==e&&(e=6);var r,i,n=pt,s=lt.crypto.ECDSA.getName,o=n.getVbyList;if(!1===n.isASN1HEX(t))throw"not ASN.1 hex string";try{r=o(t,0,[0,e,0,1],"06"),i=o(t,0,[0,e,1],"03").substr(2)}catch(t){throw"malformed X.509 certificate ECC public key"}if(this.curveName=s(r),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},lt.crypto.ECDSA.parseSigHex=function(t){var e=lt.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new E(e.r,16),s:new E(e.s,16)}},lt.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=pt,r=e.getChildIdx,i=e.getV;if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var n=r(t,0);if(2!=n.length)throw"number of signature ASN.1 sequence elements seem wrong";var s=n[0],o=n[1];if("02"!=t.substr(s,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(o,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:i(t,s),s:i(t,o)}},lt.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=lt.crypto.ECDSA.parseSigHexInHexRS(t),r=e.r,i=e.s;if("00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),"00"==i.substr(0,2)&&i.length%32==2&&(i=i.substr(2)),r.length%32==30&&(r="00"+r),i.length%32==30&&(i="00"+i),r.length%32!=0)throw"unknown ECDSA sig r length error";if(i.length%32!=0)throw"unknown ECDSA sig s length error";return r+i},lt.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),r=t.substr(t.length/2);return lt.crypto.ECDSA.hexRSSigToASN1Sig(e,r)},lt.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var r=new E(t,16),i=new E(e,16);return lt.crypto.ECDSA.biRSSigToASN1Sig(r,i)},lt.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var r=lt.asn1,i=new r.DERInteger({bigint:t}),n=new r.DERInteger({bigint:e});return new r.DERSequence({array:[i,n]}).getEncodedHex()},lt.crypto.ECDSA.getName=function(t){return"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040022"===t?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)?"secp256r1":-1!=="|secp256k1|".indexOf(t)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(t)?"secp384r1":null},void 0!==lt&&lt||(lt={}),void 0!==lt.crypto&&lt.crypto||(lt.crypto={}),lt.crypto.ECParameterDB=new function(){var t={},e={};function r(t){return new E(t,16)}this.getByName=function(r){var i=r;if(void 0!==e[i]&&(i=e[r]),void 0!==t[i])return t[i];throw"unregistered EC curve name: "+i},this.regist=function(i,n,s,o,a,h,u,c,l,d,g,p){t[i]={};var f=r(s),v=r(o),y=r(a),m=r(h),S=r(u),F=new ut(f,v,y),w=F.decodePointHex("04"+c+l);t[i].name=i,t[i].keylen=n,t[i].curve=F,t[i].G=w,t[i].n=m,t[i].h=S,t[i].oid=g,t[i].info=p;for(var b=0;b<d.length;b++)e[d[b]]=i}},lt.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),lt.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),lt.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),lt.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),lt.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),lt.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),lt.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),lt.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),lt.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),lt.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var Kt=function(){var t=function(t,r,i){return e(v.AES,t,r,i)},e=function(t,e,r,i){var n=v.enc.Hex.parse(e),s=v.enc.Hex.parse(r),o=v.enc.Hex.parse(i),a={};a.key=s,a.iv=o,a.ciphertext=n;var h=t.decrypt(a,s,{iv:o});return v.enc.Hex.stringify(h)},r=function(t,e,r){return i(v.AES,t,e,r)},i=function(t,e,r,i){var n=v.enc.Hex.parse(e),s=v.enc.Hex.parse(r),o=v.enc.Hex.parse(i),a=t.encrypt(n,s,{iv:o}),h=v.enc.Hex.parse(a.toString());return v.enc.Base64.stringify(h)},n={"AES-256-CBC":{proc:t,eproc:r,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:r,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:r,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(t,r,i){return e(v.TripleDES,t,r,i)},eproc:function(t,e,r){return i(v.TripleDES,t,e,r)},keylen:24,ivlen:8},"DES-CBC":{proc:function(t,r,i){return e(v.DES,t,r,i)},eproc:function(t,e,r){return i(v.DES,t,e,r)},keylen:8,ivlen:8}},s=function(t){var e={},r=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));r&&(e.cipher=r[1],e.ivsalt=r[2]);var i=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));i&&(e.type=i[1]);var n=-1,s=0;-1!=t.indexOf("\r\n\r\n")&&(n=t.indexOf("\r\n\r\n"),s=2),-1!=t.indexOf("\n\n")&&(n=t.indexOf("\n\n"),s=1);var o=t.indexOf("-----END");if(-1!=n&&-1!=o){var a=t.substring(n+2*s,o-s);a=a.replace(/\s+/g,""),e.data=a}return e},o=function(t,e,r){for(var i=r.substring(0,16),s=v.enc.Hex.parse(i),o=v.enc.Utf8.parse(e),a=n[t].keylen+n[t].ivlen,h="",u=null;;){var c=v.algo.MD5.create();if(null!=u&&c.update(u),c.update(o),c.update(s),u=c.finalize(),(h+=v.enc.Hex.stringify(u)).length>=2*a)break}var l={};return l.keyhex=h.substr(0,2*n[t].keylen),l.ivhex=h.substr(2*n[t].keylen,2*n[t].ivlen),l},a=function(t,e,r,i){var s=v.enc.Base64.parse(t),o=v.enc.Hex.stringify(s);return(0,n[e].proc)(o,r,i)};return{version:"1.0.0",parsePKCS5PEM:function(t){return s(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,r){return o(t,e,r)},decryptKeyB64:function(t,e,r,i){return a(t,e,r,i)},getDecryptedKeyHex:function(t,e){var r=s(t),i=(r.type,r.cipher),n=r.ivsalt,h=r.data,u=o(i,e,n).keyhex;return a(h,i,u,n)},getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,r,i,s){var a="";if(void 0!==i&&null!=i||(i="AES-256-CBC"),void 0===n[i])throw"KEYUTIL unsupported algorithm: "+i;void 0!==s&&null!=s||(s=function(t){var e=v.lib.WordArray.random(t);return v.enc.Hex.stringify(e)}(n[i].ivlen).toUpperCase());var h=function(t,e,r,i){return(0,n[e].eproc)(t,r,i)}(e,i,o(i,r,s).keyhex,s);a="-----BEGIN "+t+" PRIVATE KEY-----\r\n";return a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+i+","+s+"\r\n",a+="\r\n",a+=h.replace(/(.{64})/g,"$1\r\n"),a+="\r\n-----END "+t+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(t){var e=pt,r=e.getChildIdx,i=e.getV,n={},s=r(t,0);if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;n.ciphertext=i(t,s[1]);var o=r(t,s[0]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+o.length;if("2a864886f70d01050d"!=i(t,o[0]))throw"this only supports pkcs5PBES2";var a=r(t,o[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var h=r(t,a[1]);if(2!=h.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+h.length;if("2a864886f70d0307"!=i(t,h[0]))throw"this only supports TripleDES";n.encryptionSchemeAlg="TripleDES",n.encryptionSchemeIV=i(t,h[1]);var u=r(t,a[0]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+u.length;if("2a864886f70d01050c"!=i(t,u[0]))throw"this only supports pkcs5PBKDF2";var c=r(t,u[1]);if(c.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+c.length;n.pbkdf2Salt=i(t,c[0]);var l=i(t,c[1]);try{n.pbkdf2Iter=parseInt(l,16)}catch(t){throw"malformed format pbkdf2Iter: "+l}return n},getPBKDF2KeyHexFromParam:function(t,e){var r=v.enc.Hex.parse(t.pbkdf2Salt),i=t.pbkdf2Iter,n=v.PBKDF2(e,r,{keySize:6,iterations:i});return v.enc.Hex.stringify(n)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var r=Dt(t,"ENCRYPTED PRIVATE KEY"),i=this.parseHexOfEncryptedPKCS8(r),n=Kt.getPBKDF2KeyHexFromParam(i,e),s={};s.ciphertext=v.enc.Hex.parse(i.ciphertext);var o=v.enc.Hex.parse(n),a=v.enc.Hex.parse(i.encryptionSchemeIV),h=v.TripleDES.decrypt(s,o,{iv:a});return v.enc.Hex.stringify(h)},getKeyFromEncryptedPKCS8PEM:function(t,e){var r=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(r)},parsePlainPrivatePKCS8Hex:function(t){var e=pt,r=e.getChildIdx,i=e.getV,n={algparam:null};if("30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var s=r(t,0);if(3!=s.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(s[1],2))throw"malformed PKCS8 private key(code:003)";var o=r(t,s[1]);if(2!=o.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(o[0],2))throw"malformed PKCS8 private key(code:005)";if(n.algoid=i(t,o[0]),"06"==t.substr(o[1],2)&&(n.algparam=i(t,o[1])),"04"!=t.substr(s[2],2))throw"malformed PKCS8 private key(code:006)";return n.keyidx=e.getVidx(t,s[2]),n},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=Dt(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e,r=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==r.algoid)e=new ot;else if("2a8648ce380401"==r.algoid)e=new lt.crypto.DSA;else{if("2a8648ce3d0201"!=r.algoid)throw"unsupported private key algorithm";e=new lt.crypto.ECDSA}return e.readPKCS8PrvKeyHex(t),e},_getKeyFromPublicPKCS8Hex:function(t){var e,r=pt.getVbyList(t,0,[0,0],"06");if("2a864886f70d010101"===r)e=new ot;else if("2a8648ce380401"===r)e=new lt.crypto.DSA;else{if("2a8648ce3d0201"!==r)throw"unsupported PKCS#8 public key hex";e=new lt.crypto.ECDSA}return e.readPKCS8PubKeyHex(t),e},parsePublicRawRSAKeyHex:function(t){var e=pt,r=e.getChildIdx,i=e.getV,n={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var s=r(t,0);if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(s[0],2))throw"malformed RSA key(code:003)";if(n.n=i(t,s[0]),"02"!=t.substr(s[1],2))throw"malformed RSA key(code:004)";return n.e=i(t,s[1]),n},parsePublicPKCS8Hex:function(t){var e=pt,r=e.getChildIdx,i=e.getV,n={algparam:null},s=r(t,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length;var o=s[0];if("30"!=t.substr(o,2))throw"malformed PKCS8 public key(code:001)";var a=r(t,o);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(n.algoid=i(t,a[0]),"06"==t.substr(a[1],2)?n.algparam=i(t,a[1]):"30"==t.substr(a[1],2)&&(n.algparam={},n.algparam.p=e.getVbyList(t,a[1],[0],"02"),n.algparam.q=e.getVbyList(t,a[1],[1],"02"),n.algparam.g=e.getVbyList(t,a[1],[2],"02")),"03"!=t.substr(s[1],2))throw"malformed PKCS8 public key(code:004)";return n.key=i(t,s[1]).substr(2),n}}}();Kt.getKey=function(t,e,r){var i=(v=pt).getChildIdx,n=(v.getV,v.getVbyList),s=lt.crypto,o=s.ECDSA,a=s.DSA,h=ot,u=Dt,c=Kt;if(void 0!==h&&t instanceof h)return t;if(void 0!==o&&t instanceof o)return t;if(void 0!==a&&t instanceof a)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new o({pub:t.xy,curve:t.curve});if(void 0!==t.curve&&void 0!==t.d)return new o({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(C=new h).setPublic(t.n,t.e),C;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi)return(C=new h).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),C;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p)return(C=new h).setPrivate(t.n,t.e,t.d),C;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(C=new a).setPublic(t.p,t.q,t.g,t.y),C;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(C=new a).setPrivate(t.p,t.q,t.g,t.y,t.x),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(C=new h).setPublic(bt(t.n),bt(t.e)),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi)return(C=new h).setPrivateEx(bt(t.n),bt(t.e),bt(t.d),bt(t.p),bt(t.q),bt(t.dp),bt(t.dq),bt(t.qi)),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d)return(C=new h).setPrivate(bt(t.n),bt(t.e),bt(t.d)),C;if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){var l=(P=new o({curve:t.crv})).ecparams.keylen/4,d="04"+("0000000000"+bt(t.x)).slice(-l)+("0000000000"+bt(t.y)).slice(-l);return P.setPublicKeyHex(d),P}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){l=(P=new o({curve:t.crv})).ecparams.keylen/4,d="04"+("0000000000"+bt(t.x)).slice(-l)+("0000000000"+bt(t.y)).slice(-l);var g=("0000000000"+bt(t.d)).slice(-l);return P.setPublicKeyHex(d),P.setPrivateKeyHex(g),P}if("pkcs5prv"===r){var p,f=t,v=pt;if(9===(p=i(f,0)).length)(C=new h).readPKCS5PrvKeyHex(f);else if(6===p.length)(C=new a).readPKCS5PrvKeyHex(f);else{if(!(p.length>2&&"04"===f.substr(p[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(C=new o).readPKCS5PrvKeyHex(f)}return C}if("pkcs8prv"===r)return C=c.getKeyFromPlainPrivatePKCS8Hex(t);if("pkcs8pub"===r)return c._getKeyFromPublicPKCS8Hex(t);if("x509pub"===r)return Yt.getPublicKeyFromCertHex(t);if(-1!=t.indexOf("-END CERTIFICATE-",0)||-1!=t.indexOf("-END X509 CERTIFICATE-",0)||-1!=t.indexOf("-END TRUSTED CERTIFICATE-",0))return Yt.getPublicKeyFromCertPEM(t);if(-1!=t.indexOf("-END PUBLIC KEY-")){var y=Dt(t,"PUBLIC KEY");return c._getKeyFromPublicPKCS8Hex(y)}if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var m=u(t,"RSA PRIVATE KEY");return c.getKey(m,null,"pkcs5prv")}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var S=n(D=u(t,"DSA PRIVATE KEY"),0,[1],"02"),F=n(D,0,[2],"02"),w=n(D,0,[3],"02"),b=n(D,0,[4],"02"),_=n(D,0,[5],"02");return(C=new a).setPrivate(new E(S,16),new E(F,16),new E(w,16),new E(b,16),new E(_,16)),C}if(-1!=t.indexOf("-END PRIVATE KEY-"))return c.getKeyFromPlainPrivatePKCS8PEM(t);if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var x=c.getDecryptedKeyHex(t,e),A=new ot;return A.readPKCS5PrvKeyHex(x),A}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var P,C=n(D=c.getDecryptedKeyHex(t,e),0,[1],"04"),R=n(D,0,[2,0],"06"),T=n(D,0,[3,0],"03").substr(2);if(void 0===lt.crypto.OID.oidhex2name[R])throw"undefined OID(hex) in KJUR.crypto.OID: "+R;return(P=new o({curve:lt.crypto.OID.oidhex2name[R]})).setPublicKeyHex(T),P.setPrivateKeyHex(C),P.isPublic=!1,P}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var D;S=n(D=c.getDecryptedKeyHex(t,e),0,[1],"02"),F=n(D,0,[2],"02"),w=n(D,0,[3],"02"),b=n(D,0,[4],"02"),_=n(D,0,[5],"02");return(C=new a).setPrivate(new E(S,16),new E(F,16),new E(w,16),new E(b,16),new E(_,16)),C}if(-1!=t.indexOf("-END ENCRYPTED PRIVATE KEY-"))return c.getKeyFromEncryptedPKCS8PEM(t,e);throw"not supported argument"},Kt.generateKeypair=function(t,e){if("RSA"==t){var r=e;(o=new ot).generate(r,"10001"),o.isPrivate=!0,o.isPublic=!0;var i=new ot,n=o.n.toString(16),s=o.e.toString(16);return i.setPublic(n,s),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=i,a}if("EC"==t){var o,a,h=e,u=new lt.crypto.ECDSA({curve:h}).generateKeyPairHex();return(o=new lt.crypto.ECDSA({curve:h})).setPublicKeyHex(u.ecpubhex),o.setPrivateKeyHex(u.ecprvhex),o.isPrivate=!0,o.isPublic=!1,(i=new lt.crypto.ECDSA({curve:h})).setPublicKeyHex(u.ecpubhex),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=i,a}throw"unknown algorithm: "+t},Kt.getPEM=function(t,e,r,i,n,s){var o=lt,a=o.asn1,h=a.DERObjectIdentifier,u=a.DERInteger,c=a.ASN1Util.newObject,l=a.x509.SubjectPublicKeyInfo,d=o.crypto,g=d.DSA,p=d.ECDSA,f=ot;function y(t){return c({seq:[{int:0},{int:{bigint:t.n}},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]})}function m(t){return c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]})}function S(t){return c({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{bigint:t.y}},{int:{bigint:t.x}}]})}if((void 0!==f&&t instanceof f||void 0!==g&&t instanceof g||void 0!==p&&t instanceof p)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e))return Tt(E=new l(t).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==e&&void 0!==f&&t instanceof f&&(void 0===r||null==r)&&1==t.isPrivate)return Tt(E=y(t).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==e&&void 0!==p&&t instanceof p&&(void 0===r||null==r)&&1==t.isPrivate){var F=new h({name:t.curveName}).getEncodedHex(),w=m(t).getEncodedHex(),b="";return b+=Tt(F,"EC PARAMETERS"),b+=Tt(w,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==g&&t instanceof g&&(void 0===r||null==r)&&1==t.isPrivate)return Tt(E=S(t).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==e&&void 0!==f&&t instanceof f&&void 0!==r&&null!=r&&1==t.isPrivate){var E=y(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",E,r,i,s)}if("PKCS5PRV"==e&&void 0!==p&&t instanceof p&&void 0!==r&&null!=r&&1==t.isPrivate){E=m(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",E,r,i,s)}if("PKCS5PRV"==e&&void 0!==g&&t instanceof g&&void 0!==r&&null!=r&&1==t.isPrivate){E=S(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",E,r,i,s)}var _=function(t,e){var r=x(t,e);return new c({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:r.pbkdf2Salt}},{int:r.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:r.encryptionSchemeIV}}]}]}]},{octstr:{hex:r.ciphertext}}]}).getEncodedHex()},x=function(t,e){var r=v.lib.WordArray.random(8),i=v.lib.WordArray.random(8),n=v.PBKDF2(e,r,{keySize:6,iterations:100}),s=v.enc.Hex.parse(t),o=v.TripleDES.encrypt(s,n,{iv:i})+"",a={};return a.ciphertext=o,a.pbkdf2Salt=v.enc.Hex.stringify(r),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=v.enc.Hex.stringify(i),a};if("PKCS8PRV"==e&&void 0!=f&&t instanceof f&&1==t.isPrivate){var A=y(t).getEncodedHex();E=c({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===r||null==r?Tt(E,"PRIVATE KEY"):Tt(w=_(E,r),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==p&&t instanceof p&&1==t.isPrivate){A=new c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),E=c({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===r||null==r?Tt(E,"PRIVATE KEY"):Tt(w=_(E,r),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==g&&t instanceof g&&1==t.isPrivate){A=new u({bigint:t.x}).getEncodedHex(),E=c({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===r||null==r?Tt(E,"PRIVATE KEY"):Tt(w=_(E,r),"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},Kt.getKeyFromCSRPEM=function(t){var e=Dt(t,"CERTIFICATE REQUEST");return Kt.getKeyFromCSRHex(e)},Kt.getKeyFromCSRHex=function(t){var e=Kt.parseCSRHex(t);return Kt.getKey(e.p8pubkeyhex,null,"pkcs8pub")},Kt.parseCSRHex=function(t){var e=pt,r=e.getChildIdx,i=e.getTLV,n={},s=t;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var o=r(s,0);if(o.length<1)throw"malformed CSR(code:002)";if("30"!=s.substr(o[0],2))throw"malformed CSR(code:003)";var a=r(s,o[0]);if(a.length<3)throw"malformed CSR(code:004)";return n.p8pubkeyhex=i(s,a[2]),n},Kt.getJWKFromKey=function(t){var e={};if(t instanceof ot&&t.isPrivate)return e.kty="RSA",e.n=wt(t.n.toString(16)),e.e=wt(t.e.toString(16)),e.d=wt(t.d.toString(16)),e.p=wt(t.p.toString(16)),e.q=wt(t.q.toString(16)),e.dp=wt(t.dmp1.toString(16)),e.dq=wt(t.dmq1.toString(16)),e.qi=wt(t.coeff.toString(16)),e;if(t instanceof ot&&t.isPublic)return e.kty="RSA",e.n=wt(t.n.toString(16)),e.e=wt(t.e.toString(16)),e;if(t instanceof lt.crypto.ECDSA&&t.isPrivate){if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;var r=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=wt(r.x),e.y=wt(r.y),e.d=wt(t.prvKeyHex),e}if(t instanceof lt.crypto.ECDSA&&t.isPublic){var i;if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;r=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=wt(r.x),e.y=wt(r.y),e}throw"not supported key object"},ot.getPosArrayOfChildrenFromHex=function(t){return pt.getChildIdx(t,0)},ot.getHexValueArrayOfChildrenFromHex=function(t){var e,r=pt.getV,i=r(t,(e=ot.getPosArrayOfChildrenFromHex(t))[0]),n=r(t,e[1]),s=r(t,e[2]),o=r(t,e[3]),a=r(t,e[4]),h=r(t,e[5]),u=r(t,e[6]),c=r(t,e[7]),l=r(t,e[8]);return(e=new Array).push(i,n,s,o,a,h,u,c,l),e},ot.prototype.readPrivateKeyFromPEMString=function(t){var e=Dt(t),r=ot.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},ot.prototype.readPKCS5PrvKeyHex=function(t){var e=ot.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},ot.prototype.readPKCS8PrvKeyHex=function(t){var e,r,i,n,s,o,a,h,u=pt,c=u.getVbyList;if(!1===u.isASN1HEX(t))throw"not ASN.1 hex string";try{e=c(t,0,[2,0,1],"02"),r=c(t,0,[2,0,2],"02"),i=c(t,0,[2,0,3],"02"),n=c(t,0,[2,0,4],"02"),s=c(t,0,[2,0,5],"02"),o=c(t,0,[2,0,6],"02"),a=c(t,0,[2,0,7],"02"),h=c(t,0,[2,0,8],"02")}catch(t){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(e,r,i,n,s,o,a,h)},ot.prototype.readPKCS5PubKeyHex=function(t){var e=pt,r=e.getV;if(!1===e.isASN1HEX(t))throw"keyHex is not ASN.1 hex string";var i=e.getChildIdx(t,0);if(2!==i.length||"02"!==t.substr(i[0],2)||"02"!==t.substr(i[1],2))throw"wrong hex for PKCS#5 public key";var n=r(t,i[0]),s=r(t,i[1]);this.setPublic(n,s)},ot.prototype.readPKCS8PubKeyHex=function(t){var e=pt;if(!1===e.isASN1HEX(t))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==e.getTLVbyList(t,0,[0,0]))throw"not PKCS8 RSA public key";var r=e.getTLVbyList(t,0,[1,0]);this.readPKCS5PubKeyHex(r)},ot.prototype.readCertPubKeyHex=function(t,e){var r,i;(r=new Yt).readCertHex(t),i=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(i)};var Lt=new RegExp("");function qt(t,e){for(var r="",i=e/4-t.length,n=0;n<i;n++)r+="0";return r+t}function Wt(t,e,r){for(var i="",n=0;i.length<e;)i+=xt(r(At(t+String.fromCharCode.apply(String,[(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n])))),n+=1;return i}function Jt(t){for(var e in lt.crypto.Util.DIGESTINFOHEAD){var r=lt.crypto.Util.DIGESTINFOHEAD[e],i=r.length;if(t.substring(0,i)==r)return[e,t.substring(i)]}return[]}function Yt(){var t=pt,e=t.getChildIdx,r=t.getV,i=t.getTLV,n=t.getVbyList,s=t.getTLVbyList,o=t.getIdxbyList,a=t.getVidx,h=t.oidname,u=Yt,c=Dt;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==s(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return n(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return h(n(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return s(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return u.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return s(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return u.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var t=n(this.hex,0,[0,4+this.foffset,0]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getNotAfter=function(){var t=n(this.hex,0,[0,4+this.foffset,1]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getPublicKeyHex=function(){return t.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return o(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var t=this.getPublicKeyIdx();return o(this.hex,t,[1,0],"30")},this.getPublicKey=function(){return Kt.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return h(n(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return n(this.hex,0,[2],"03",!0)},this.verifySignature=function(t){var e=this.getSignatureAlgorithmName(),r=this.getSignatureValueHex(),i=s(this.hex,0,[0],"30"),n=new lt.crypto.Signature({alg:e});return n.init(t),n.updateHex(i),n.verify(r)},this.parseExt=function(){if(3!==this.version)return-1;var r=o(this.hex,0,[0,7,0],"30"),i=e(this.hex,r);this.aExtInfo=new Array;for(var s=0;s<i.length;s++){var h={critical:!1},u=0;3===e(this.hex,i[s]).length&&(h.critical=!0,u=1),h.oid=t.hextooidstr(n(this.hex,i[s],[0],"06"));var c=o(this.hex,i[s],[1+u]);h.vidx=a(this.hex,c),this.aExtInfo.push(h)}},this.getExtInfo=function(t){var e=this.aExtInfo,r=t;if(t.match(/^[0-9.]+$/)||(r=lt.asn1.x509.OID.name2oid(t)),""!==r)for(var i=0;i<e.length;i++)if(e[i].oid===r)return e[i]},this.getExtBasicConstraints=function(){var t=this.getExtInfo("basicConstraints");if(void 0===t)return t;var e=r(this.hex,t.vidx);if(""===e)return{};if("0101ff"===e)return{cA:!0};if("0101ff02"===e.substr(0,8)){var i=r(e,6);return{cA:!0,pathLen:parseInt(i,16)}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";var e=r(this.hex,t.vidx);if(e.length%2!=0||e.length<=2)throw"malformed key usage value";var i=parseInt(e.substr(0,2)),n=parseInt(e.substr(2),16).toString(2);return n.substr(0,n.length-i)},this.getExtKeyUsageString=function(){for(var t=this.getExtKeyUsageBin(),e=new Array,r=0;r<t.length;r++)"1"==t.substr(r,1)&&e.push(Yt.KEYUSAGE_NAME[r]);return e.join(",")},this.getExtSubjectKeyIdentifier=function(){var t=this.getExtInfo("subjectKeyIdentifier");return void 0===t?t:r(this.hex,t.vidx)},this.getExtAuthorityKeyIdentifier=function(){var t=this.getExtInfo("authorityKeyIdentifier");if(void 0===t)return t;for(var n={},s=i(this.hex,t.vidx),o=e(s,0),a=0;a<o.length;a++)"80"===s.substr(o[a],2)&&(n.kid=r(s,o[a]));return n},this.getExtExtKeyUsageName=function(){var t=this.getExtInfo("extKeyUsage");if(void 0===t)return t;var n=new Array,s=i(this.hex,t.vidx);if(""===s)return n;for(var o=e(s,0),a=0;a<o.length;a++)n.push(h(r(s,o[a])));return n},this.getExtSubjectAltName=function(){for(var t=this.getExtSubjectAltName2(),e=new Array,r=0;r<t.length;r++)"DNS"===t[r][0]&&e.push(t[r][1]);return e},this.getExtSubjectAltName2=function(){var t,n,s,o=this.getExtInfo("subjectAltName");if(void 0===o)return o;for(var a=new Array,h=i(this.hex,o.vidx),u=e(h,0),c=0;c<u.length;c++)s=h.substr(u[c],2),t=r(h,u[c]),"81"===s&&(n=_t(t),a.push(["MAIL",n])),"82"===s&&(n=_t(t),a.push(["DNS",n])),"84"===s&&(n=Yt.hex2dn(t,0),a.push(["DN",n])),"86"===s&&(n=_t(t),a.push(["URI",n])),"87"===s&&(n=Ut(t),a.push(["IP",n]));return a},this.getExtCRLDistributionPointsURI=function(){var t=this.getExtInfo("cRLDistributionPoints");if(void 0===t)return t;for(var r=new Array,i=e(this.hex,t.vidx),s=0;s<i.length;s++)try{var o=_t(n(this.hex,i[s],[0,0,0],"86"));r.push(o)}catch(t){}return r},this.getExtAIAInfo=function(){var t=this.getExtInfo("authorityInfoAccess");if(void 0===t)return t;for(var r={ocsp:[],caissuer:[]},i=e(this.hex,t.vidx),s=0;s<i.length;s++){var o=n(this.hex,i[s],[0],"06"),a=n(this.hex,i[s],[1],"86");"2b06010505073001"===o&&r.ocsp.push(_t(a)),"2b06010505073002"===o&&r.caissuer.push(_t(a))}return r},this.getExtCertificatePolicies=function(){var t=this.getExtInfo("certificatePolicies");if(void 0===t)return t;for(var s=i(this.hex,t.vidx),o=[],a=e(s,0),u=0;u<a.length;u++){var c={},l=e(s,a[u]);if(c.id=h(r(s,l[0])),2===l.length)for(var d=e(s,l[1]),g=0;g<d.length;g++){var p=n(s,d[g],[0],"06");"2b06010505070201"===p?c.cps=_t(n(s,d[g],[1])):"2b06010505070202"===p&&(c.unotice=_t(n(s,d[g],[1,0])))}o.push(c)}return o},this.readCertPEM=function(t){this.readCertHex(c(t))},this.readCertHex=function(t){this.hex=t,this.getVersion();try{o(this.hex,0,[0,7],"a3"),this.parseExt()}catch(t){}},this.getInfo=function(){var t,e,r;if(t="Basic Fields\n",t+="  serial number: "+this.getSerialNumberHex()+"\n",t+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",t+="  issuer: "+this.getIssuerString()+"\n",t+="  notBefore: "+this.getNotBefore()+"\n",t+="  notAfter: "+this.getNotAfter()+"\n",t+="  subject: "+this.getSubjectString()+"\n",t+="  subject public key info: \n",t+="    key algorithm: "+(e=this.getPublicKey()).type+"\n","RSA"===e.type&&(t+="    n="+Mt(e.n.toString(16)).substr(0,16)+"...\n",t+="    e="+Mt(e.e.toString(16))+"\n"),void 0!==(r=this.aExtInfo)&&null!==r){t+="X509v3 Extensions:\n";for(var i=0;i<r.length;i++){var n=r[i],s=lt.asn1.x509.OID.oid2name(n.oid);""===s&&(s=n.oid);var o="";if(!0===n.critical&&(o="CRITICAL"),t+="  "+s+" "+o+":\n","basicConstraints"===s){var a=this.getExtBasicConstraints();void 0===a.cA?t+="    {}\n":(t+="    cA=true",void 0!==a.pathLen&&(t+=", pathLen="+a.pathLen),t+="\n")}else if("keyUsage"===s)t+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===s)t+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===s){var h=this.getExtAuthorityKeyIdentifier();void 0!==h.kid&&(t+="    kid="+h.kid+"\n")}else{if("extKeyUsage"===s)t+="    "+this.getExtExtKeyUsageName().join(", ")+"\n";else if("subjectAltName"===s)t+="    "+this.getExtSubjectAltName2()+"\n";else if("cRLDistributionPoints"===s)t+="    "+this.getExtCRLDistributionPointsURI()+"\n";else if("authorityInfoAccess"===s){var u=this.getExtAIAInfo();void 0!==u.ocsp&&(t+="    ocsp: "+u.ocsp.join(",")+"\n"),void 0!==u.caissuer&&(t+="    caissuer: "+u.caissuer.join(",")+"\n")}else if("certificatePolicies"===s)for(var c=this.getExtCertificatePolicies(),l=0;l<c.length;l++)void 0!==c[l].id&&(t+="    policy oid: "+c[l].id+"\n"),void 0!==c[l].cps&&(t+="    cps: "+c[l].cps+"\n")}}}return t+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",t+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}Lt.compile("[^0-9a-f]","gi"),ot.prototype.sign=function(t,e){var r,i=(r=t,lt.crypto.Util.hashString(r,e));return this.signWithMessageHash(i,e)},ot.prototype.signWithMessageHash=function(t,e){var r=nt(lt.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return qt(this.doPrivate(r).toString(16),this.n.bitLength())},ot.prototype.signPSS=function(t,e,r){var i,n=(i=At(t),lt.crypto.Util.hashHex(i,e));return void 0===r&&(r=-1),this.signWithMessageHashPSS(n,e,r)},ot.prototype.signWithMessageHashPSS=function(t,e,r){var i,n=xt(t),s=n.length,o=this.n.bitLength()-1,a=Math.ceil(o/8),h=function(t){return lt.crypto.Util.hashHex(t,e)};if(-1===r||void 0===r)r=s;else if(-2===r)r=a-s-2;else if(r<-2)throw"invalid salt length";if(a<s+r+2)throw"data too long";var u="";r>0&&(u=new Array(r),(new it).nextBytes(u),u=String.fromCharCode.apply(String,u));var c=xt(h(At("\0\0\0\0\0\0\0\0"+n+u))),l=[];for(i=0;i<a-r-s-2;i+=1)l[i]=0;var d=String.fromCharCode.apply(String,l)+""+u,g=Wt(c,d.length,h),p=[];for(i=0;i<d.length;i+=1)p[i]=d.charCodeAt(i)^g.charCodeAt(i);var f=65280>>8*a-o&255;for(p[0]&=~f,i=0;i<s;i++)p.push(c.charCodeAt(i));return p.push(188),qt(this.doPrivate(new E(p)).toString(16),this.n.bitLength())},ot.prototype.verify=function(t,e){var r=nt(e=(e=e.replace(Lt,"")).replace(/[ \n]+/g,""),16);if(r.bitLength()>this.n.bitLength())return 0;var i=Jt(this.doPublic(r).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;var n,s=i[0];return i[1]==(n=t,lt.crypto.Util.hashString(n,s))},ot.prototype.verifyWithMessageHash=function(t,e){var r=nt(e=(e=e.replace(Lt,"")).replace(/[ \n]+/g,""),16);if(r.bitLength()>this.n.bitLength())return 0;var i=Jt(this.doPublic(r).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;i[0];return i[1]==t},ot.prototype.verifyPSS=function(t,e,r,i){var n,s=(n=At(t),lt.crypto.Util.hashHex(n,r));return void 0===i&&(i=-1),this.verifyWithMessageHashPSS(s,e,r,i)},ot.prototype.verifyWithMessageHashPSS=function(t,e,r,i){var n=new E(e,16);if(n.bitLength()>this.n.bitLength())return!1;var s,o=function(t){return lt.crypto.Util.hashHex(t,r)},a=xt(t),h=a.length,u=this.n.bitLength()-1,c=Math.ceil(u/8);if(-1===i||void 0===i)i=h;else if(-2===i)i=c-h-2;else if(i<-2)throw"invalid salt length";if(c<h+i+2)throw"data too long";var l=this.doPublic(n).toByteArray();for(s=0;s<l.length;s+=1)l[s]&=255;for(;l.length<c;)l.unshift(0);if(188!==l[c-1])throw"encoded message does not end in 0xbc";var d=(l=String.fromCharCode.apply(String,l)).substr(0,c-h-1),g=l.substr(d.length,h),p=65280>>8*c-u&255;if(0!=(d.charCodeAt(0)&p))throw"bits beyond keysize not zero";var f=Wt(g,d.length,o),v=[];for(s=0;s<d.length;s+=1)v[s]=d.charCodeAt(s)^f.charCodeAt(s);v[0]&=~p;var y=c-h-i-2;for(s=0;s<y;s+=1)if(0!==v[s])throw"leftmost octets not zero";if(1!==v[y])throw"0x01 marker not found";return g===xt(o(At("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,v.slice(-i)))))},ot.SALT_LEN_HLEN=-1,ot.SALT_LEN_MAX=-2,ot.SALT_LEN_RECOVER=-2,Yt.hex2dn=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed DN";for(var r=new Array,i=pt.getChildIdx(t,e),n=0;n<i.length;n++)r.push(Yt.hex2rdn(t,i[n]));return"/"+(r=r.map(function(t){return t.replace("/","\\/")})).join("/")},Yt.hex2rdn=function(t,e){if(void 0===e&&(e=0),"31"!==t.substr(e,2))throw"malformed RDN";for(var r=new Array,i=pt.getChildIdx(t,e),n=0;n<i.length;n++)r.push(Yt.hex2attrTypeValue(t,i[n]));return(r=r.map(function(t){return t.replace("+","\\+")})).join("+")},Yt.hex2attrTypeValue=function(t,e){var r=pt,i=r.getV;if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed attribute type and value";var n=r.getChildIdx(t,e);2!==n.length||t.substr(n[0],2);var s=i(t,n[0]),o=lt.asn1.ASN1Util.oidHexToInt(s);return lt.asn1.x509.OID.oid2atype(o)+"="+xt(i(t,n[1]))},Yt.getPublicKeyFromCertHex=function(t){var e=new Yt;return e.readCertHex(t),e.getPublicKey()},Yt.getPublicKeyFromCertPEM=function(t){var e=new Yt;return e.readCertPEM(t),e.getPublicKey()},Yt.getPublicKeyInfoPropOfCertPEM=function(t){var e,r,i=pt.getVbyList,n={};return n.algparam=null,(e=new Yt).readCertPEM(t),r=e.getPublicKeyHex(),n.keyhex=i(r,0,[1],"03").substr(2),n.algoid=i(r,0,[0,0],"06"),"2a8648ce3d0201"===n.algoid&&(n.algparam=i(r,0,[0,1],"06")),n},Yt.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==lt&&lt||(lt={}),void 0!==lt.jws&&lt.jws||(lt.jws={}),lt.jws.JWS=function(){var t=lt.jws.JWS.isSafeJSONString;this.parseJWS=function(e,r){if(void 0===this.parsedJWS||!r&&void 0===this.parsedJWS.sigvalH){var i=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==i)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var n=i[1],s=i[2],o=i[3],a=n+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=n,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=o,this.parsedJWS.si=a,!r){var h=bt(o),u=nt(h,16);this.parsedJWS.sigvalH=h,this.parsedJWS.sigvalBI=u}var c=gt(n),l=gt(s);if(this.parsedJWS.headS=c,this.parsedJWS.payloadS=l,!t(c,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+c}}},lt.jws.JWS.sign=function(t,e,r,i,n){var s,o,a,h=lt,u=h.jws.JWS,c=u.readSafeJSONString,l=u.isSafeJSONString,d=h.crypto,g=(d.ECDSA,d.Mac),p=d.Signature,f=JSON;if("string"!=typeof e&&"object"!=typeof e)throw"spHeader must be JSON string or object: "+e;if("object"==typeof e&&(o=e,s=f.stringify(o)),"string"==typeof e){if(!l(s=e))throw"JWS Head is not safe JSON string: "+s;o=c(s)}if(a=r,"object"==typeof r&&(a=f.stringify(r)),""!=t&&null!=t||void 0===o.alg||(t=o.alg),""!=t&&null!=t&&void 0===o.alg&&(o.alg=t,s=f.stringify(o)),t!==o.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+o.alg;var v=null;if(void 0===u.jwsalg2sigalg[t])throw"unsupported alg name: "+t;v=u.jwsalg2sigalg[t];var y=dt(s)+"."+dt(a),m="";if("Hmac"==v.substr(0,4)){if(void 0===i)throw"mac key shall be specified for HS* alg";var S=new g({alg:v,prov:"cryptojs",pass:i});S.updateString(y),m=S.doFinal()}else{var F;if(-1!=v.indexOf("withECDSA"))(F=new p({alg:v})).init(i,n),F.updateString(y),hASN1Sig=F.sign(),m=lt.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig);else if("none"!=v)(F=new p({alg:v})).init(i,n),F.updateString(y),m=F.sign()}return y+"."+wt(m)},lt.jws.JWS.verify=function(t,e,r){var i,n=lt,s=n.jws.JWS,o=s.readSafeJSONString,a=n.crypto,h=a.ECDSA,u=a.Mac,c=a.Signature;i=ot;var l=t.split(".");if(3!==l.length)return!1;var d=l[0]+"."+l[1],g=bt(l[2]),p=o(gt(l[0])),f=null,v=null;if(void 0===p.alg)throw"algorithm not specified in header";if((v=(f=p.alg).substr(0,2),null!=r&&"[object Array]"===Object.prototype.toString.call(r)&&r.length>0)&&-1==(":"+r.join(":")+":").indexOf(":"+f+":"))throw"algorithm '"+f+"' not accepted in the list";if("none"!=f&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&(e=Kt.getKey(e)),!("RS"!=v&&"PS"!=v||e instanceof i))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==v&&!(e instanceof h))throw"key shall be a ECDSA obj for ES* algs";var y=null;if(void 0===s.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+f;if("none"==(y=s.jwsalg2sigalg[f]))throw"not supported";if("Hmac"==y.substr(0,4)){if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var m=new u({alg:y,pass:e});return m.updateString(d),g==m.doFinal()}if(-1!=y.indexOf("withECDSA")){var S,F=null;try{F=h.concatSigToASN1Sig(g)}catch(t){return!1}return(S=new c({alg:y})).init(e),S.updateString(d),S.verify(F)}return(S=new c({alg:y})).init(e),S.updateString(d),S.verify(g)},lt.jws.JWS.parse=function(t){var e,r,i,n=t.split("."),s={};if(2!=n.length&&3!=n.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=n[0],r=n[1],3==n.length&&(i=n[2]),s.headerObj=lt.jws.JWS.readSafeJSONString(gt(e)),s.payloadObj=lt.jws.JWS.readSafeJSONString(gt(r)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=gt(r):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==i&&(s.sigHex=bt(i)),s},lt.jws.JWS.verifyJWT=function(t,e,r){var i=lt.jws,n=i.JWS,s=n.readSafeJSONString,o=n.inArray,a=n.includedArray,h=t.split("."),u=h[0],c=h[1],l=(bt(h[2]),s(gt(u))),d=s(gt(c));if(void 0===l.alg)return!1;if(void 0===r.alg)throw"acceptField.alg shall be specified";if(!o(l.alg,r.alg))return!1;if(void 0!==d.iss&&"object"==typeof r.iss&&!o(d.iss,r.iss))return!1;if(void 0!==d.sub&&"object"==typeof r.sub&&!o(d.sub,r.sub))return!1;if(void 0!==d.aud&&"object"==typeof r.aud)if("string"==typeof d.aud){if(!o(d.aud,r.aud))return!1}else if("object"==typeof d.aud&&!a(d.aud,r.aud))return!1;var g=i.IntDate.getNow();return void 0!==r.verifyAt&&"number"==typeof r.verifyAt&&(g=r.verifyAt),void 0!==r.gracePeriod&&"number"==typeof r.gracePeriod||(r.gracePeriod=0),!(void 0!==d.exp&&"number"==typeof d.exp&&d.exp+r.gracePeriod<g)&&(!(void 0!==d.nbf&&"number"==typeof d.nbf&&g<d.nbf-r.gracePeriod)&&(!(void 0!==d.iat&&"number"==typeof d.iat&&g<d.iat-r.gracePeriod)&&((void 0===d.jti||void 0===r.jti||d.jti===r.jti)&&!!n.verify(t,e,r.alg))))},lt.jws.JWS.includedArray=function(t,e){var r=lt.jws.JWS.inArray;if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var i=0;i<t.length;i++)if(!r(t[i],e))return!1;return!0},lt.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var r=0;r<e.length;r++)if(e[r]==t)return!0;return!1},lt.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},lt.jws.JWS.isSafeJSONString=function(t,e,r){var i=null;try{return"object"!=typeof(i=ct(t))?0:i.constructor===Array?0:(e&&(e[r]=i),1)}catch(t){return 0}},lt.jws.JWS.readSafeJSONString=function(t){var e=null;try{return"object"!=typeof(e=ct(t))?null:e.constructor===Array?null:e}catch(t){return null}},lt.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},lt.jws.JWS.getJWKthumbprint=function(t){if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var r=At(e);return wt(lt.crypto.Util.hashHex(r,"sha256"))},lt.jws.IntDate={},lt.jws.IntDate.get=function(t){var e=lt.jws.IntDate,r=e.getNow,i=e.getZulu;if("now"==t)return r();if("now + 1hour"==t)return r()+3600;if("now + 1day"==t)return r()+86400;if("now + 1month"==t)return r()+2592e3;if("now + 1year"==t)return r()+31536e3;if(t.match(/Z$/))return i(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},lt.jws.IntDate.getZulu=function(t){return kt(t)},lt.jws.IntDate.getNow=function(){return~~(new Date/1e3)},lt.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},lt.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t);return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"},e.SecureRandom=it,e.rng_seed_time=X,e.BigInteger=E,e.RSAKey=ot,e.ECDSA=lt.crypto.ECDSA,e.DSA=lt.crypto.DSA,e.Signature=lt.crypto.Signature,e.MessageDigest=lt.crypto.MessageDigest,e.Mac=lt.crypto.Mac,e.Cipher=lt.crypto.Cipher,e.KEYUTIL=Kt,e.ASN1HEX=pt,e.X509=Yt,e.CryptoJS=v,e.b64tohex=w,e.b64toBA=b,e.stoBA=ft,e.BAtos=vt,e.BAtohex=yt,e.stohex=mt,e.stob64=function(t){return F(mt(t))},e.stob64u=function(t){return St(F(mt(t)))},e.b64utos=function(t){return vt(b(Ft(t)))},e.b64tob64u=St,e.b64utob64=Ft,e.hex2b64=F,e.hextob64u=wt,e.b64utohex=bt,e.utf8tob64u=dt,e.b64utoutf8=gt,e.utf8tob64=function(t){return F(Bt(Ot(t)))},e.b64toutf8=function(t){return decodeURIComponent(Nt(w(t)))},e.utf8tohex=Et,e.hextoutf8=_t,e.hextorstr=xt,e.rstrtohex=At,e.hextob64=Pt,e.hextob64nl=Ct,e.b64nltohex=Rt,e.hextopem=Tt,e.pemtohex=Dt,e.hextoArrayBuffer=function(t){if(t.length%2!=0)throw"input is not even length";if(null==t.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var e=new ArrayBuffer(t.length/2),r=new DataView(e),i=0;i<t.length/2;i++)r.setUint8(i,parseInt(t.substr(2*i,2),16));return e},e.ArrayBuffertohex=function(t){for(var e="",r=new DataView(t),i=0;i<t.byteLength;i++)e+=("00"+r.getUint8(i).toString(16)).slice(-2);return e},e.zulutomsec=It,e.zulutosec=kt,e.zulutodate=function(t){return new Date(It(t))},e.datetozulu=function(t,e,r){var i,n=t.getUTCFullYear();if(e){if(n<1950||2049<n)throw"not proper year for UTCTime: "+n;i=(""+n).slice(-2)}else i=("000"+n).slice(-4);if(i+=("0"+(t.getUTCMonth()+1)).slice(-2),i+=("0"+t.getUTCDate()).slice(-2),i+=("0"+t.getUTCHours()).slice(-2),i+=("0"+t.getUTCMinutes()).slice(-2),i+=("0"+t.getUTCSeconds()).slice(-2),r){var s=t.getUTCMilliseconds();0!==s&&(i+="."+(s=(s=("00"+s).slice(-3)).replace(/0+$/g,"")))}return i+="Z"},e.uricmptohex=Bt,e.hextouricmp=Nt,e.ipv6tohex=Ht,e.hextoipv6=jt,e.hextoip=Ut,e.iptohex=function(t){var e="malformed IP address";if(!(t=t.toLowerCase(t)).match(/^[0-9.]+$/)){if(t.match(/^[0-9a-f:]+$/)&&-1!==t.indexOf(":"))return Ht(t);throw e}var r=t.split(".");if(4!==r.length)throw e;var i="";try{for(var n=0;n<4;n++)i+=("0"+parseInt(r[n]).toString(16)).slice(-2);return i}catch(t){throw e}},e.encodeURIComponentAll=Ot,e.newline_toUnix=function(t){return t=t.replace(/\r\n/gm,"\n")},e.newline_toDos=function(t){return t=(t=t.replace(/\r\n/gm,"\n")).replace(/\n/gm,"\r\n")},e.hextoposhex=Mt,e.intarystrtohex=Vt,e.strdiffidx=function(t,e){var r=t.length;t.length>e.length&&(r=e.length);for(var i=0;i<r;i++)if(t.charCodeAt(i)!=e.charCodeAt(i))return i;return t.length!=e.length?r:-1},e.KJUR=lt,e.crypto=lt.crypto,e.asn1=lt.asn1,e.jws=lt.jws,e.lang=lt.lang}).call(this,r(19).Buffer)}});